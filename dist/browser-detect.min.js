!function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?module.exports=n():e.browser=n()}(this,function(){"use strict";function e(e){if(void 0===e&&"undefined"==typeof process)throw"Please give navigator.\n> browser(navigator or window.navigator)";return"undefined"!=typeof process?{name:"node",version:process.version.slice(1)}:[["edge",/Edge\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)$/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+)\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/]].filter(function(n){return n[1].test(e.userAgent)}).map(function(n){var r=n[1].exec(e.userAgent),o=r&&r[1].split(/[._]/).slice(0,3);return o&&o.length<3&&Array.prototype.push.apply(o,1===o.length?[0,0]:[0]),{name:n[0],version:o.join(".")}}).shift()}var n,r,o,t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return function(e){function i(e,n){return S.call(e,n)}function f(e,n){var r,o,t,i,f,u,s,c,l,p,a,d,y=n&&n.split("/"),m=w.map,h=m&&m["*"]||{};if(e){for(e=e.split("/"),f=e.length-1,w.nodeIdCompat&&j.test(e[f])&&(e[f]=e[f].replace(j,"")),"."===e[0].charAt(0)&&y&&(d=y.slice(0,y.length-1),e=d.concat(e)),l=0;l<e.length;l++)if("."===(a=e[l]))e.splice(l,1),l-=1;else if(".."===a){if(0===l||1===l&&".."===e[2]||".."===e[l-1])continue;l>0&&(e.splice(l-1,2),l-=2)}e=e.join("/")}if((y||h)&&m){for(r=e.split("/"),l=r.length;l>0;l-=1){if(o=r.slice(0,l).join("/"),y)for(p=y.length;p>0;p-=1)if((t=m[y.slice(0,p).join("/")])&&(t=t[o])){i=t,u=l;break}if(i)break;!s&&h&&h[o]&&(s=h[o],c=l)}!i&&s&&(i=s,u=c),i&&(r.splice(0,u,i),e=r.join("/"))}return e}function u(n,r){return function(){var o=A.call(arguments,0);return"string"!=typeof o[0]&&1===o.length&&o.push(null),m.apply(e,o.concat([n,r]))}}function s(e){return function(n){return f(n,e)}}function c(e){return function(n){v[e]=n}}function l(n){if(i(b,n)){var r=b[n];delete b[n],x[n]=!0,y.apply(e,r)}if(!i(v,n)&&!i(x,n))throw new Error("No "+n);return v[n]}function p(e){var n,r=e?e.indexOf("!"):-1;return r>-1&&(n=e.substring(0,r),e=e.substring(r+1,e.length)),[n,e]}function a(e){return e?p(e):[]}function d(e){return function(){return w&&w.config&&w.config[e]||{}}}var y,m,h,g,v={},b={},w={},x={},S=Object.prototype.hasOwnProperty,A=[].slice,j=/\.js$/;h=function(e,n){var r,o=p(e),t=o[0],i=n[1];return e=o[1],t&&(t=f(t,i),r=l(t)),t?e=r&&r.normalize?r.normalize(e,s(i)):f(e,i):(e=f(e,i),o=p(e),t=o[0],e=o[1],t&&(r=l(t))),{f:t?t+"!"+e:e,n:e,pr:t,p:r}},g={require:function(e){return u(e)},exports:function(e){var n=v[e];return void 0!==n?n:v[e]={}},module:function(e){return{id:e,uri:"",exports:v[e],config:d(e)}}},y=function(n,r,o,f){var s,p,d,y,m,w,S,A=[],j=void 0===o?"undefined":t(o);if(f=f||n,w=a(f),"undefined"===j||"function"===j){for(r=!r.length&&o.length?["require","exports","module"]:r,m=0;m<r.length;m+=1)if(y=h(r[m],w),"require"===(p=y.f))A[m]=g.require(n);else if("exports"===p)A[m]=g.exports(n),S=!0;else if("module"===p)s=A[m]=g.module(n);else if(i(v,p)||i(b,p)||i(x,p))A[m]=l(p);else{if(!y.p)throw new Error(n+" missing "+p);y.p.load(y.n,u(f,!0),c(p),{}),A[m]=v[p]}d=o?o.apply(v[n],A):void 0,n&&(s&&s.exports!==e&&s.exports!==v[n]?v[n]=s.exports:d===e&&S||(v[n]=d))}else n&&(v[n]=o)},n=r=m=function(n,r,o,t,i){if("string"==typeof n)return g[n]?g[n](r):l(h(n,a(r)).f);if(!n.splice){if(w=n,w.deps&&m(w.deps,w.callback),!r)return;r.splice?(n=r,r=o,o=null):n=e}return r=r||function(){},"function"==typeof o&&(o=t,t=i),t?y(e,n,r,o):setTimeout(function(){y(e,n,r,o)},4),m},m.config=function(e){return m(e)},n._defined=v,o=function(e,n,r){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");n.splice||(r=n,n=[]),i(v,e)||i(b,e)||(b[e]=[e,n,r])},o.amd={jQuery:!0}}(),o("almond",function(){}),void 0===Array.prototype.map&&(Array.prototype.map=function(e){for(var n=[],r=0,o=this.length;r<o;r++)n.push(e(this[r]));return n}),void 0===Array.prototype.filter&&(Array.prototype.filter=function(e){for(var n=[],r=0,o=this.length;r<o;r++)e(this[r])&&n.push(this[r]);return n}),o("polyfills",function(){}),o("browser-detect",["polyfills"],function(){return e}),o("main",["browser-detect"],function(e){return function(){var n="undefined"!=typeof window?window.navigator:n;return e(n)}}),window.browser=r("main")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFsbW9uZC5qcyIsImJyb3dzZXItZGV0ZWN0LmpzIiwibWFpbi5qcyIsInBvbHlmaWxscy5qcyJdLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwiZmFjdG9yeSIsInRoaXMiLCJuYXZpZ2F0b3IiLCJwcm9jZXNzIiwiYnJvd3NlcnMiLCJuYW1lIiwiZWxlbWVudCIsInZlcnNpb24iLCJzbGljZSIsInByb3RvdHlwZSIsInB1c2giLCJ0ZXN0IiwidXNlckFnZW50Iiwiam9pbiIsIm1hdGNoIiwic3BsaXQiLCJsZW5ndGgiLCJzaGlmdCIsInJlcXVpcmVqcyIsImRlZmluaW5nIiwiZGVmaW5lIiwiaGFzT3duIiwibm9ybWFsaXplIiwiYmFzZU5hbWUiLCJqIiwicGFydCIsIm5vcm1hbGl6ZWRCYXNlUGFydHMiLCJiYXNlUGFydHMiLCJtYXAiLCJzdGFyTWFwIiwic3RhckkiLCJsYXN0SW5kZXgiLCJjb25maWciLCJub2RlSWRDb21wYXQiLCJqc1N1ZmZpeFJlZ0V4cCIsInJlcGxhY2UiLCJpIiwiY29uY2F0Iiwic3BsaWNlIiwibWFwVmFsdWUiLCJuYW1lUGFydHMiLCJuYW1lU2VnbWVudCIsImZvdW5kTWFwIiwiZm91bmRJIiwiZm91bmRTdGFyTWFwIiwibWFrZVJlcXVpcmUiLCJyZWxOYW1lIiwiZm9yY2VTeW5jIiwiYXJncyIsImFwcyIsImNhbGwiLCJhcmd1bWVudHMiLCJtYWtlTm9ybWFsaXplIiwibWFrZUxvYWQiLCJ3YWl0aW5nIiwidmFsdWUiLCJtYWluIiwiYXBwbHkiLCJjYWxsRGVwIiwiaGFzUHJvcCIsImRlZmluZWQiLCJ1bmRlZiIsInNwbGl0UHJlZml4IiwicHJlZml4IiwiRXJyb3IiLCJpbmRleCIsImluZGV4T2YiLCJtYWtlUmVsUGFydHMiLCJzdWJzdHJpbmciLCJtYWtlTWFwIiwicGx1Z2luIiwibWFrZUNvbmZpZyIsImUiLCJoYW5kbGVycyIsInBhcnRzIiwicmVsUmVzb3VyY2VOYW1lIiwicmVsUGFydHMiLCJmIiwibiIsInByIiwicmVxdWlyZSIsImlkIiwidXJpIiwiY2pzTW9kdWxlIiwiZGVwTmFtZSIsInVzaW5nRXhwb3J0cyIsImRlcHMiLCJjYWxsYmFjayIsImNhbGxiYWNrVHlwZSIsIl90eXBlb2YiLCJwIiwibG9hZCIsInJldCIsInVuZGVmaW5lZCIsIl9yZXF1aXJlIiwicmVxIiwiYWx0Iiwic2V0VGltZW91dCIsImNmZyIsIl9kZWZpbmVkIiwiYW1kIiwialF1ZXJ5IiwiQXJyYXkiLCJmaWx0ZXIiLCJydiIsImZuIiwibCJdLCJtYXBwaW5ncyI6IjJGQUFBQSxPQUFBQyxRQUFBQyxtQkFJQUMsS0FBQSxXQUNBLDJCQUdBLE9BQUEsS0FBQUMsR0FBQSxtQkFBQUMsU0FDQUMsS0FBQUEsc0dDdUJBQyxLQUFBQyxPQUVBQyxRQUFBSixRQUFBSSxRQUFBQyxNQUFBLE1ERkFDLE9BQUFDLHNCQUFBSCxnQkFBQSwyQkFBQSxTQUFBLHFEQUFBLFFBQUEsOEJBQUEsVUFBQSxnQ0FBQSxRQUFBLDhCQUFBLFFBQUEsNkJBQUEsS0FBQSw0Q0FBQSxLQUFBLHdDQUFBLEtBQUEsaUJBQUEsT0FBQSxzQ0FBQSxVQUFBLHdCQUFBLE1BQUEsMkNBQUEsU0FBQSxvREFBQSxNQUFBRCxHQUFBLEdBQUFLLEtBQUFULEVBQUFVLGFBQUFQLElBQUFBLFNBQUFDLEdBQUFDLEdBQUFBLEdBQUFBLEVBQUFBLEdBQUFNLEtBQUFYLEVBQUFVLFdBQUFMLEVBQUFPLEdBQUFBLEVBQUEsR0FBQUMsTUFBQSxRQUFBUCxNQUFBLEVBQUEsRUFBQSxPQUFBRCxJQUFBQSxFQUFBUyxPQUFBLG1FQUFBVCxRQUFBQSxFQUFBTSxLQUFBLFFFOUJBSSxXRlFBQyxHQUlBQyxFQUpBQyxvTkFBQSxVQUtBQyxzQ0FpQkEsUUFBQUMsR0FBQWpCLEVBQUFrQixHQUFBLEdBQ0FDLEdBQUFDLEVBQUFDLEVBQ0FDLEVBQ0FDLEVBQ0FDLElBRUFDLEVBQ0F6QixFQUNBQSxFQUNBMEIsSUFFQUosRUFBQUosR0FBQUEsRUFBQVIsTUFBQSxLQUNBYSxFQUFBSSxFQUFBSixJQUNB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ZCxFQUNBZSx1QkFJQS9DLEVBQUFqRCxJQUFBQSxFQUFBaUYsRUFBQUMsS0dqYkFuRSxFQUFBZ0YsbUJBTUFoRixFQVBBLFNBQUEsNkNBVUFrRixNQUFBN0YsVUFBQThGLElBQUEsU0FBQVYsVUFDQXBGLGdDQUdBK0YsRUFBQTlGLEtBQUEwQixFQUFBbkMsS0FBQW1DLElBQ0EsT0FBQXFFLFNBS0FaLEtBQUFTLE1BQUE3RixVQUFBOEYsU0FDQW5GLE1BQUFYLFVBQUE4RixPQUFBLFNBQUFFLEdGckJBLElBQUEsU0FBQXZHLEVBQUFBLEVBQUF3RyxFQUFBekcsS0FBQWUsT0FBQW9CLEVBQUFzRSxFQUFBdEUsSUFDQXFFLEVBQUF4RyxLQUFBbUMsS0FBQW9FLEVBQUE5RixLQUFBVCxLQUFBbUMsR0FEQSxPQUlBb0UsS0FDQXBGLEVBQUEsWUFBQSxjQ0RBQSxFRjJCQSxrQkFBQSxhQUFBIiwiZmlsZSI6ImJyb3dzZXItZGV0ZWN0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAbGljZW5zZSBhbG1vbmQgMC4zLjMgQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnMuXG4gKiBSZWxlYXNlZCB1bmRlciBNSVQgbGljZW5zZSwgaHR0cDovL2dpdGh1Yi5jb20vcmVxdWlyZWpzL2FsbW9uZC9MSUNFTlNFXG4gKi9cbi8vR29pbmcgc2xvcHB5IHRvIGF2b2lkICd1c2Ugc3RyaWN0JyBzdHJpbmcgY29zdCwgYnV0IHN0cmljdCBwcmFjdGljZXMgc2hvdWxkXG4vL2JlIGZvbGxvd2VkLlxuLypnbG9iYWwgc2V0VGltZW91dDogZmFsc2UgKi9cblxudmFyIHJlcXVpcmVqcywgcmVxdWlyZSwgZGVmaW5lO1xuKGZ1bmN0aW9uICh1bmRlZikge1xuICAgIHZhciBtYWluLCByZXEsIG1ha2VNYXAsIGhhbmRsZXJzLFxuICAgICAgICBkZWZpbmVkID0ge30sXG4gICAgICAgIHdhaXRpbmcgPSB7fSxcbiAgICAgICAgY29uZmlnID0ge30sXG4gICAgICAgIGRlZmluaW5nID0ge30sXG4gICAgICAgIGhhc093biA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksXG4gICAgICAgIGFwcyA9IFtdLnNsaWNlLFxuICAgICAgICBqc1N1ZmZpeFJlZ0V4cCA9IC9cXC5qcyQvO1xuXG4gICAgZnVuY3Rpb24gaGFzUHJvcChvYmosIHByb3ApIHtcbiAgICAgICAgcmV0dXJuIGhhc093bi5jYWxsKG9iaiwgcHJvcCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2l2ZW4gYSByZWxhdGl2ZSBtb2R1bGUgbmFtZSwgbGlrZSAuL3NvbWV0aGluZywgbm9ybWFsaXplIGl0IHRvXG4gICAgICogYSByZWFsIG5hbWUgdGhhdCBjYW4gYmUgbWFwcGVkIHRvIGEgcGF0aC5cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSB0aGUgcmVsYXRpdmUgbmFtZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBiYXNlTmFtZSBhIHJlYWwgbmFtZSB0aGF0IHRoZSBuYW1lIGFyZyBpcyByZWxhdGl2ZVxuICAgICAqIHRvLlxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9IG5vcm1hbGl6ZWQgbmFtZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG5vcm1hbGl6ZShuYW1lLCBiYXNlTmFtZSkge1xuICAgICAgICB2YXIgbmFtZVBhcnRzLCBuYW1lU2VnbWVudCwgbWFwVmFsdWUsIGZvdW5kTWFwLCBsYXN0SW5kZXgsXG4gICAgICAgICAgICBmb3VuZEksIGZvdW5kU3Rhck1hcCwgc3RhckksIGksIGosIHBhcnQsIG5vcm1hbGl6ZWRCYXNlUGFydHMsXG4gICAgICAgICAgICBiYXNlUGFydHMgPSBiYXNlTmFtZSAmJiBiYXNlTmFtZS5zcGxpdChcIi9cIiksXG4gICAgICAgICAgICBtYXAgPSBjb25maWcubWFwLFxuICAgICAgICAgICAgc3Rhck1hcCA9IChtYXAgJiYgbWFwWycqJ10pIHx8IHt9O1xuXG4gICAgICAgIC8vQWRqdXN0IGFueSByZWxhdGl2ZSBwYXRocy5cbiAgICAgICAgaWYgKG5hbWUpIHtcbiAgICAgICAgICAgIG5hbWUgPSBuYW1lLnNwbGl0KCcvJyk7XG4gICAgICAgICAgICBsYXN0SW5kZXggPSBuYW1lLmxlbmd0aCAtIDE7XG5cbiAgICAgICAgICAgIC8vIElmIHdhbnRpbmcgbm9kZSBJRCBjb21wYXRpYmlsaXR5LCBzdHJpcCAuanMgZnJvbSBlbmRcbiAgICAgICAgICAgIC8vIG9mIElEcy4gSGF2ZSB0byBkbyB0aGlzIGhlcmUsIGFuZCBub3QgaW4gbmFtZVRvVXJsXG4gICAgICAgICAgICAvLyBiZWNhdXNlIG5vZGUgYWxsb3dzIGVpdGhlciAuanMgb3Igbm9uIC5qcyB0byBtYXBcbiAgICAgICAgICAgIC8vIHRvIHNhbWUgZmlsZS5cbiAgICAgICAgICAgIGlmIChjb25maWcubm9kZUlkQ29tcGF0ICYmIGpzU3VmZml4UmVnRXhwLnRlc3QobmFtZVtsYXN0SW5kZXhdKSkge1xuICAgICAgICAgICAgICAgIG5hbWVbbGFzdEluZGV4XSA9IG5hbWVbbGFzdEluZGV4XS5yZXBsYWNlKGpzU3VmZml4UmVnRXhwLCAnJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFN0YXJ0cyB3aXRoIGEgJy4nIHNvIG5lZWQgdGhlIGJhc2VOYW1lXG4gICAgICAgICAgICBpZiAobmFtZVswXS5jaGFyQXQoMCkgPT09ICcuJyAmJiBiYXNlUGFydHMpIHtcbiAgICAgICAgICAgICAgICAvL0NvbnZlcnQgYmFzZU5hbWUgdG8gYXJyYXksIGFuZCBsb3Agb2ZmIHRoZSBsYXN0IHBhcnQsXG4gICAgICAgICAgICAgICAgLy9zbyB0aGF0IC4gbWF0Y2hlcyB0aGF0ICdkaXJlY3RvcnknIGFuZCBub3QgbmFtZSBvZiB0aGUgYmFzZU5hbWUnc1xuICAgICAgICAgICAgICAgIC8vbW9kdWxlLiBGb3IgaW5zdGFuY2UsIGJhc2VOYW1lIG9mICdvbmUvdHdvL3RocmVlJywgbWFwcyB0b1xuICAgICAgICAgICAgICAgIC8vJ29uZS90d28vdGhyZWUuanMnLCBidXQgd2Ugd2FudCB0aGUgZGlyZWN0b3J5LCAnb25lL3R3bycgZm9yXG4gICAgICAgICAgICAgICAgLy90aGlzIG5vcm1hbGl6YXRpb24uXG4gICAgICAgICAgICAgICAgbm9ybWFsaXplZEJhc2VQYXJ0cyA9IGJhc2VQYXJ0cy5zbGljZSgwLCBiYXNlUGFydHMubGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICAgICAgbmFtZSA9IG5vcm1hbGl6ZWRCYXNlUGFydHMuY29uY2F0KG5hbWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL3N0YXJ0IHRyaW1Eb3RzXG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbmFtZS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHBhcnQgPSBuYW1lW2ldO1xuICAgICAgICAgICAgICAgIGlmIChwYXJ0ID09PSAnLicpIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZS5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIGkgLT0gMTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBhcnQgPT09ICcuLicpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgYXQgdGhlIHN0YXJ0LCBvciBwcmV2aW91cyB2YWx1ZSBpcyBzdGlsbCAuLixcbiAgICAgICAgICAgICAgICAgICAgLy8ga2VlcCB0aGVtIHNvIHRoYXQgd2hlbiBjb252ZXJ0ZWQgdG8gYSBwYXRoIGl0IG1heVxuICAgICAgICAgICAgICAgICAgICAvLyBzdGlsbCB3b3JrIHdoZW4gY29udmVydGVkIHRvIGEgcGF0aCwgZXZlbiB0aG91Z2hcbiAgICAgICAgICAgICAgICAgICAgLy8gYXMgYW4gSUQgaXQgaXMgbGVzcyB0aGFuIGlkZWFsLiBJbiBsYXJnZXIgcG9pbnRcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVsZWFzZXMsIG1heSBiZSBiZXR0ZXIgdG8ganVzdCBraWNrIG91dCBhbiBlcnJvci5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT09IDAgfHwgKGkgPT09IDEgJiYgbmFtZVsyXSA9PT0gJy4uJykgfHwgbmFtZVtpIC0gMV0gPT09ICcuLicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lLnNwbGljZShpIC0gMSwgMik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpIC09IDI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL2VuZCB0cmltRG90c1xuXG4gICAgICAgICAgICBuYW1lID0gbmFtZS5qb2luKCcvJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvL0FwcGx5IG1hcCBjb25maWcgaWYgYXZhaWxhYmxlLlxuICAgICAgICBpZiAoKGJhc2VQYXJ0cyB8fCBzdGFyTWFwKSAmJiBtYXApIHtcbiAgICAgICAgICAgIG5hbWVQYXJ0cyA9IG5hbWUuc3BsaXQoJy8nKTtcblxuICAgICAgICAgICAgZm9yIChpID0gbmFtZVBhcnRzLmxlbmd0aDsgaSA+IDA7IGkgLT0gMSkge1xuICAgICAgICAgICAgICAgIG5hbWVTZWdtZW50ID0gbmFtZVBhcnRzLnNsaWNlKDAsIGkpLmpvaW4oXCIvXCIpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGJhc2VQYXJ0cykge1xuICAgICAgICAgICAgICAgICAgICAvL0ZpbmQgdGhlIGxvbmdlc3QgYmFzZU5hbWUgc2VnbWVudCBtYXRjaCBpbiB0aGUgY29uZmlnLlxuICAgICAgICAgICAgICAgICAgICAvL1NvLCBkbyBqb2lucyBvbiB0aGUgYmlnZ2VzdCB0byBzbWFsbGVzdCBsZW5ndGhzIG9mIGJhc2VQYXJ0cy5cbiAgICAgICAgICAgICAgICAgICAgZm9yIChqID0gYmFzZVBhcnRzLmxlbmd0aDsgaiA+IDA7IGogLT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFwVmFsdWUgPSBtYXBbYmFzZVBhcnRzLnNsaWNlKDAsIGopLmpvaW4oJy8nKV07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vYmFzZU5hbWUgc2VnbWVudCBoYXMgIGNvbmZpZywgZmluZCBpZiBpdCBoYXMgb25lIGZvclxuICAgICAgICAgICAgICAgICAgICAgICAgLy90aGlzIG5hbWUuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWFwVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXBWYWx1ZSA9IG1hcFZhbHVlW25hbWVTZWdtZW50XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobWFwVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9NYXRjaCwgdXBkYXRlIG5hbWUgdG8gdGhlIG5ldyB2YWx1ZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmRNYXAgPSBtYXBWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmRJID0gaTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGZvdW5kTWFwKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vQ2hlY2sgZm9yIGEgc3RhciBtYXAgbWF0Y2gsIGJ1dCBqdXN0IGhvbGQgb24gdG8gaXQsXG4gICAgICAgICAgICAgICAgLy9pZiB0aGVyZSBpcyBhIHNob3J0ZXIgc2VnbWVudCBtYXRjaCBsYXRlciBpbiBhIG1hdGNoaW5nXG4gICAgICAgICAgICAgICAgLy9jb25maWcsIHRoZW4gZmF2b3Igb3ZlciB0aGlzIHN0YXIgbWFwLlxuICAgICAgICAgICAgICAgIGlmICghZm91bmRTdGFyTWFwICYmIHN0YXJNYXAgJiYgc3Rhck1hcFtuYW1lU2VnbWVudF0pIHtcbiAgICAgICAgICAgICAgICAgICAgZm91bmRTdGFyTWFwID0gc3Rhck1hcFtuYW1lU2VnbWVudF07XG4gICAgICAgICAgICAgICAgICAgIHN0YXJJID0gaTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghZm91bmRNYXAgJiYgZm91bmRTdGFyTWFwKSB7XG4gICAgICAgICAgICAgICAgZm91bmRNYXAgPSBmb3VuZFN0YXJNYXA7XG4gICAgICAgICAgICAgICAgZm91bmRJID0gc3Rhckk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChmb3VuZE1hcCkge1xuICAgICAgICAgICAgICAgIG5hbWVQYXJ0cy5zcGxpY2UoMCwgZm91bmRJLCBmb3VuZE1hcCk7XG4gICAgICAgICAgICAgICAgbmFtZSA9IG5hbWVQYXJ0cy5qb2luKCcvJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmFtZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBtYWtlUmVxdWlyZShyZWxOYW1lLCBmb3JjZVN5bmMpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vQSB2ZXJzaW9uIG9mIGEgcmVxdWlyZSBmdW5jdGlvbiB0aGF0IHBhc3NlcyBhIG1vZHVsZU5hbWVcbiAgICAgICAgICAgIC8vdmFsdWUgZm9yIGl0ZW1zIHRoYXQgbWF5IG5lZWQgdG9cbiAgICAgICAgICAgIC8vbG9vayB1cCBwYXRocyByZWxhdGl2ZSB0byB0aGUgbW9kdWxlTmFtZVxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBhcHMuY2FsbChhcmd1bWVudHMsIDApO1xuXG4gICAgICAgICAgICAvL0lmIGZpcnN0IGFyZyBpcyBub3QgcmVxdWlyZSgnc3RyaW5nJyksIGFuZCB0aGVyZSBpcyBvbmx5XG4gICAgICAgICAgICAvL29uZSBhcmcsIGl0IGlzIHRoZSBhcnJheSBmb3JtIHdpdGhvdXQgYSBjYWxsYmFjay4gSW5zZXJ0XG4gICAgICAgICAgICAvL2EgbnVsbCBzbyB0aGF0IHRoZSBmb2xsb3dpbmcgY29uY2F0IGlzIGNvcnJlY3QuXG4gICAgICAgICAgICBpZiAodHlwZW9mIGFyZ3NbMF0gIT09ICdzdHJpbmcnICYmIGFyZ3MubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgYXJncy5wdXNoKG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlcS5hcHBseSh1bmRlZiwgYXJncy5jb25jYXQoW3JlbE5hbWUsIGZvcmNlU3luY10pKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBtYWtlTm9ybWFsaXplKHJlbE5hbWUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gbm9ybWFsaXplKG5hbWUsIHJlbE5hbWUpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG1ha2VMb2FkKGRlcE5hbWUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgZGVmaW5lZFtkZXBOYW1lXSA9IHZhbHVlO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNhbGxEZXAobmFtZSkge1xuICAgICAgICBpZiAoaGFzUHJvcCh3YWl0aW5nLCBuYW1lKSkge1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSB3YWl0aW5nW25hbWVdO1xuICAgICAgICAgICAgZGVsZXRlIHdhaXRpbmdbbmFtZV07XG4gICAgICAgICAgICBkZWZpbmluZ1tuYW1lXSA9IHRydWU7XG4gICAgICAgICAgICBtYWluLmFwcGx5KHVuZGVmLCBhcmdzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghaGFzUHJvcChkZWZpbmVkLCBuYW1lKSAmJiAhaGFzUHJvcChkZWZpbmluZywgbmFtZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gJyArIG5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZWZpbmVkW25hbWVdO1xuICAgIH1cblxuICAgIC8vVHVybnMgYSBwbHVnaW4hcmVzb3VyY2UgdG8gW3BsdWdpbiwgcmVzb3VyY2VdXG4gICAgLy93aXRoIHRoZSBwbHVnaW4gYmVpbmcgdW5kZWZpbmVkIGlmIHRoZSBuYW1lXG4gICAgLy9kaWQgbm90IGhhdmUgYSBwbHVnaW4gcHJlZml4LlxuICAgIGZ1bmN0aW9uIHNwbGl0UHJlZml4KG5hbWUpIHtcbiAgICAgICAgdmFyIHByZWZpeCxcbiAgICAgICAgICAgIGluZGV4ID0gbmFtZSA/IG5hbWUuaW5kZXhPZignIScpIDogLTE7XG4gICAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgICAgICBwcmVmaXggPSBuYW1lLnN1YnN0cmluZygwLCBpbmRleCk7XG4gICAgICAgICAgICBuYW1lID0gbmFtZS5zdWJzdHJpbmcoaW5kZXggKyAxLCBuYW1lLmxlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtwcmVmaXgsIG5hbWVdO1xuICAgIH1cblxuICAgIC8vQ3JlYXRlcyBhIHBhcnRzIGFycmF5IGZvciBhIHJlbE5hbWUgd2hlcmUgZmlyc3QgcGFydCBpcyBwbHVnaW4gSUQsXG4gICAgLy9zZWNvbmQgcGFydCBpcyByZXNvdXJjZSBJRC4gQXNzdW1lcyByZWxOYW1lIGhhcyBhbHJlYWR5IGJlZW4gbm9ybWFsaXplZC5cbiAgICBmdW5jdGlvbiBtYWtlUmVsUGFydHMocmVsTmFtZSkge1xuICAgICAgICByZXR1cm4gcmVsTmFtZSA/IHNwbGl0UHJlZml4KHJlbE5hbWUpIDogW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTWFrZXMgYSBuYW1lIG1hcCwgbm9ybWFsaXppbmcgdGhlIG5hbWUsIGFuZCB1c2luZyBhIHBsdWdpblxuICAgICAqIGZvciBub3JtYWxpemF0aW9uIGlmIG5lY2Vzc2FyeS4gR3JhYnMgYSByZWYgdG8gcGx1Z2luXG4gICAgICogdG9vLCBhcyBhbiBvcHRpbWl6YXRpb24uXG4gICAgICovXG4gICAgbWFrZU1hcCA9IGZ1bmN0aW9uIChuYW1lLCByZWxQYXJ0cykge1xuICAgICAgICB2YXIgcGx1Z2luLFxuICAgICAgICAgICAgcGFydHMgPSBzcGxpdFByZWZpeChuYW1lKSxcbiAgICAgICAgICAgIHByZWZpeCA9IHBhcnRzWzBdLFxuICAgICAgICAgICAgcmVsUmVzb3VyY2VOYW1lID0gcmVsUGFydHNbMV07XG5cbiAgICAgICAgbmFtZSA9IHBhcnRzWzFdO1xuXG4gICAgICAgIGlmIChwcmVmaXgpIHtcbiAgICAgICAgICAgIHByZWZpeCA9IG5vcm1hbGl6ZShwcmVmaXgsIHJlbFJlc291cmNlTmFtZSk7XG4gICAgICAgICAgICBwbHVnaW4gPSBjYWxsRGVwKHByZWZpeCk7XG4gICAgICAgIH1cblxuICAgICAgICAvL05vcm1hbGl6ZSBhY2NvcmRpbmdcbiAgICAgICAgaWYgKHByZWZpeCkge1xuICAgICAgICAgICAgaWYgKHBsdWdpbiAmJiBwbHVnaW4ubm9ybWFsaXplKSB7XG4gICAgICAgICAgICAgICAgbmFtZSA9IHBsdWdpbi5ub3JtYWxpemUobmFtZSwgbWFrZU5vcm1hbGl6ZShyZWxSZXNvdXJjZU5hbWUpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbmFtZSA9IG5vcm1hbGl6ZShuYW1lLCByZWxSZXNvdXJjZU5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmFtZSA9IG5vcm1hbGl6ZShuYW1lLCByZWxSZXNvdXJjZU5hbWUpO1xuICAgICAgICAgICAgcGFydHMgPSBzcGxpdFByZWZpeChuYW1lKTtcbiAgICAgICAgICAgIHByZWZpeCA9IHBhcnRzWzBdO1xuICAgICAgICAgICAgbmFtZSA9IHBhcnRzWzFdO1xuICAgICAgICAgICAgaWYgKHByZWZpeCkge1xuICAgICAgICAgICAgICAgIHBsdWdpbiA9IGNhbGxEZXAocHJlZml4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vVXNpbmcgcmlkaWN1bG91cyBwcm9wZXJ0eSBuYW1lcyBmb3Igc3BhY2UgcmVhc29uc1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZjogcHJlZml4ID8gcHJlZml4ICsgJyEnICsgbmFtZSA6IG5hbWUsIC8vZnVsbE5hbWVcbiAgICAgICAgICAgIG46IG5hbWUsXG4gICAgICAgICAgICBwcjogcHJlZml4LFxuICAgICAgICAgICAgcDogcGx1Z2luXG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIG1ha2VDb25maWcobmFtZSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIChjb25maWcgJiYgY29uZmlnLmNvbmZpZyAmJiBjb25maWcuY29uZmlnW25hbWVdKSB8fCB7fTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBoYW5kbGVycyA9IHtcbiAgICAgICAgcmVxdWlyZTogZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBtYWtlUmVxdWlyZShuYW1lKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXhwb3J0czogZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgIHZhciBlID0gZGVmaW5lZFtuYW1lXTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChkZWZpbmVkW25hbWVdID0ge30pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBtb2R1bGU6IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGlkOiBuYW1lLFxuICAgICAgICAgICAgICAgIHVyaTogJycsXG4gICAgICAgICAgICAgICAgZXhwb3J0czogZGVmaW5lZFtuYW1lXSxcbiAgICAgICAgICAgICAgICBjb25maWc6IG1ha2VDb25maWcobmFtZSlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgbWFpbiA9IGZ1bmN0aW9uIChuYW1lLCBkZXBzLCBjYWxsYmFjaywgcmVsTmFtZSkge1xuICAgICAgICB2YXIgY2pzTW9kdWxlLCBkZXBOYW1lLCByZXQsIG1hcCwgaSwgcmVsUGFydHMsXG4gICAgICAgICAgICBhcmdzID0gW10sXG4gICAgICAgICAgICBjYWxsYmFja1R5cGUgPSB0eXBlb2YgY2FsbGJhY2ssXG4gICAgICAgICAgICB1c2luZ0V4cG9ydHM7XG5cbiAgICAgICAgLy9Vc2UgbmFtZSBpZiBubyByZWxOYW1lXG4gICAgICAgIHJlbE5hbWUgPSByZWxOYW1lIHx8IG5hbWU7XG4gICAgICAgIHJlbFBhcnRzID0gbWFrZVJlbFBhcnRzKHJlbE5hbWUpO1xuXG4gICAgICAgIC8vQ2FsbCB0aGUgY2FsbGJhY2sgdG8gZGVmaW5lIHRoZSBtb2R1bGUsIGlmIG5lY2Vzc2FyeS5cbiAgICAgICAgaWYgKGNhbGxiYWNrVHlwZSA9PT0gJ3VuZGVmaW5lZCcgfHwgY2FsbGJhY2tUeXBlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAvL1B1bGwgb3V0IHRoZSBkZWZpbmVkIGRlcGVuZGVuY2llcyBhbmQgcGFzcyB0aGUgb3JkZXJlZFxuICAgICAgICAgICAgLy92YWx1ZXMgdG8gdGhlIGNhbGxiYWNrLlxuICAgICAgICAgICAgLy9EZWZhdWx0IHRvIFtyZXF1aXJlLCBleHBvcnRzLCBtb2R1bGVdIGlmIG5vIGRlcHNcbiAgICAgICAgICAgIGRlcHMgPSAhZGVwcy5sZW5ndGggJiYgY2FsbGJhY2subGVuZ3RoID8gWydyZXF1aXJlJywgJ2V4cG9ydHMnLCAnbW9kdWxlJ10gOiBkZXBzO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGRlcHMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgICAgICAgICBtYXAgPSBtYWtlTWFwKGRlcHNbaV0sIHJlbFBhcnRzKTtcbiAgICAgICAgICAgICAgICBkZXBOYW1lID0gbWFwLmY7XG5cbiAgICAgICAgICAgICAgICAvL0Zhc3QgcGF0aCBDb21tb25KUyBzdGFuZGFyZCBkZXBlbmRlbmNpZXMuXG4gICAgICAgICAgICAgICAgaWYgKGRlcE5hbWUgPT09IFwicmVxdWlyZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZ3NbaV0gPSBoYW5kbGVycy5yZXF1aXJlKG5hbWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGVwTmFtZSA9PT0gXCJleHBvcnRzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9Db21tb25KUyBtb2R1bGUgc3BlYyAxLjFcbiAgICAgICAgICAgICAgICAgICAgYXJnc1tpXSA9IGhhbmRsZXJzLmV4cG9ydHMobmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIHVzaW5nRXhwb3J0cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkZXBOYW1lID09PSBcIm1vZHVsZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vQ29tbW9uSlMgbW9kdWxlIHNwZWMgMS4xXG4gICAgICAgICAgICAgICAgICAgIGNqc01vZHVsZSA9IGFyZ3NbaV0gPSBoYW5kbGVycy5tb2R1bGUobmFtZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoYXNQcm9wKGRlZmluZWQsIGRlcE5hbWUpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNQcm9wKHdhaXRpbmcsIGRlcE5hbWUpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNQcm9wKGRlZmluaW5nLCBkZXBOYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBhcmdzW2ldID0gY2FsbERlcChkZXBOYW1lKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1hcC5wKSB7XG4gICAgICAgICAgICAgICAgICAgIG1hcC5wLmxvYWQobWFwLm4sIG1ha2VSZXF1aXJlKHJlbE5hbWUsIHRydWUpLCBtYWtlTG9hZChkZXBOYW1lKSwge30pO1xuICAgICAgICAgICAgICAgICAgICBhcmdzW2ldID0gZGVmaW5lZFtkZXBOYW1lXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IobmFtZSArICcgbWlzc2luZyAnICsgZGVwTmFtZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXQgPSBjYWxsYmFjayA/IGNhbGxiYWNrLmFwcGx5KGRlZmluZWRbbmFtZV0sIGFyZ3MpIDogdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICBpZiAobmFtZSkge1xuICAgICAgICAgICAgICAgIC8vSWYgc2V0dGluZyBleHBvcnRzIHZpYSBcIm1vZHVsZVwiIGlzIGluIHBsYXksXG4gICAgICAgICAgICAgICAgLy9mYXZvciB0aGF0IG92ZXIgcmV0dXJuIHZhbHVlIGFuZCBleHBvcnRzLiBBZnRlciB0aGF0LFxuICAgICAgICAgICAgICAgIC8vZmF2b3IgYSBub24tdW5kZWZpbmVkIHJldHVybiB2YWx1ZSBvdmVyIGV4cG9ydHMgdXNlLlxuICAgICAgICAgICAgICAgIGlmIChjanNNb2R1bGUgJiYgY2pzTW9kdWxlLmV4cG9ydHMgIT09IHVuZGVmICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBjanNNb2R1bGUuZXhwb3J0cyAhPT0gZGVmaW5lZFtuYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICBkZWZpbmVkW25hbWVdID0gY2pzTW9kdWxlLmV4cG9ydHM7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXQgIT09IHVuZGVmIHx8ICF1c2luZ0V4cG9ydHMpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9Vc2UgdGhlIHJldHVybiB2YWx1ZSBmcm9tIHRoZSBmdW5jdGlvbi5cbiAgICAgICAgICAgICAgICAgICAgZGVmaW5lZFtuYW1lXSA9IHJldDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAobmFtZSkge1xuICAgICAgICAgICAgLy9NYXkganVzdCBiZSBhbiBvYmplY3QgZGVmaW5pdGlvbiBmb3IgdGhlIG1vZHVsZS4gT25seVxuICAgICAgICAgICAgLy93b3JyeSBhYm91dCBkZWZpbmluZyBpZiBoYXZlIGEgbW9kdWxlIG5hbWUuXG4gICAgICAgICAgICBkZWZpbmVkW25hbWVdID0gY2FsbGJhY2s7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcmVxdWlyZWpzID0gcmVxdWlyZSA9IHJlcSA9IGZ1bmN0aW9uIChkZXBzLCBjYWxsYmFjaywgcmVsTmFtZSwgZm9yY2VTeW5jLCBhbHQpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBkZXBzID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBpZiAoaGFuZGxlcnNbZGVwc10pIHtcbiAgICAgICAgICAgICAgICAvL2NhbGxiYWNrIGluIHRoaXMgY2FzZSBpcyByZWFsbHkgcmVsTmFtZVxuICAgICAgICAgICAgICAgIHJldHVybiBoYW5kbGVyc1tkZXBzXShjYWxsYmFjayk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL0p1c3QgcmV0dXJuIHRoZSBtb2R1bGUgd2FudGVkLiBJbiB0aGlzIHNjZW5hcmlvLCB0aGVcbiAgICAgICAgICAgIC8vZGVwcyBhcmcgaXMgdGhlIG1vZHVsZSBuYW1lLCBhbmQgc2Vjb25kIGFyZyAoaWYgcGFzc2VkKVxuICAgICAgICAgICAgLy9pcyBqdXN0IHRoZSByZWxOYW1lLlxuICAgICAgICAgICAgLy9Ob3JtYWxpemUgbW9kdWxlIG5hbWUsIGlmIGl0IGNvbnRhaW5zIC4gb3IgLi5cbiAgICAgICAgICAgIHJldHVybiBjYWxsRGVwKG1ha2VNYXAoZGVwcywgbWFrZVJlbFBhcnRzKGNhbGxiYWNrKSkuZik7XG4gICAgICAgIH0gZWxzZSBpZiAoIWRlcHMuc3BsaWNlKSB7XG4gICAgICAgICAgICAvL2RlcHMgaXMgYSBjb25maWcgb2JqZWN0LCBub3QgYW4gYXJyYXkuXG4gICAgICAgICAgICBjb25maWcgPSBkZXBzO1xuICAgICAgICAgICAgaWYgKGNvbmZpZy5kZXBzKSB7XG4gICAgICAgICAgICAgICAgcmVxKGNvbmZpZy5kZXBzLCBjb25maWcuY2FsbGJhY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrLnNwbGljZSkge1xuICAgICAgICAgICAgICAgIC8vY2FsbGJhY2sgaXMgYW4gYXJyYXksIHdoaWNoIG1lYW5zIGl0IGlzIGEgZGVwZW5kZW5jeSBsaXN0LlxuICAgICAgICAgICAgICAgIC8vQWRqdXN0IGFyZ3MgaWYgdGhlcmUgYXJlIGRlcGVuZGVuY2llc1xuICAgICAgICAgICAgICAgIGRlcHMgPSBjYWxsYmFjaztcbiAgICAgICAgICAgICAgICBjYWxsYmFjayA9IHJlbE5hbWU7XG4gICAgICAgICAgICAgICAgcmVsTmFtZSA9IG51bGw7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGRlcHMgPSB1bmRlZjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vU3VwcG9ydCByZXF1aXJlKFsnYSddKVxuICAgICAgICBjYWxsYmFjayA9IGNhbGxiYWNrIHx8IGZ1bmN0aW9uICgpIHt9O1xuXG4gICAgICAgIC8vSWYgcmVsTmFtZSBpcyBhIGZ1bmN0aW9uLCBpdCBpcyBhbiBlcnJiYWNrIGhhbmRsZXIsXG4gICAgICAgIC8vc28gcmVtb3ZlIGl0LlxuICAgICAgICBpZiAodHlwZW9mIHJlbE5hbWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHJlbE5hbWUgPSBmb3JjZVN5bmM7XG4gICAgICAgICAgICBmb3JjZVN5bmMgPSBhbHQ7XG4gICAgICAgIH1cblxuICAgICAgICAvL1NpbXVsYXRlIGFzeW5jIGNhbGxiYWNrO1xuICAgICAgICBpZiAoZm9yY2VTeW5jKSB7XG4gICAgICAgICAgICBtYWluKHVuZGVmLCBkZXBzLCBjYWxsYmFjaywgcmVsTmFtZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvL1VzaW5nIGEgbm9uLXplcm8gdmFsdWUgYmVjYXVzZSBvZiBjb25jZXJuIGZvciB3aGF0IG9sZCBicm93c2Vyc1xuICAgICAgICAgICAgLy9kbywgYW5kIGxhdGVzdCBicm93c2VycyBcInVwZ3JhZGVcIiB0byA0IGlmIGxvd2VyIHZhbHVlIGlzIHVzZWQ6XG4gICAgICAgICAgICAvL2h0dHA6Ly93d3cud2hhdHdnLm9yZy9zcGVjcy93ZWItYXBwcy9jdXJyZW50LXdvcmsvbXVsdGlwYWdlL3RpbWVycy5odG1sI2RvbS13aW5kb3d0aW1lcnMtc2V0dGltZW91dDpcbiAgICAgICAgICAgIC8vSWYgd2FudCBhIHZhbHVlIGltbWVkaWF0ZWx5LCB1c2UgcmVxdWlyZSgnaWQnKSBpbnN0ZWFkIC0tIHNvbWV0aGluZ1xuICAgICAgICAgICAgLy90aGF0IHdvcmtzIGluIGFsbW9uZCBvbiB0aGUgZ2xvYmFsIGxldmVsLCBidXQgbm90IGd1YXJhbnRlZWQgYW5kXG4gICAgICAgICAgICAvL3VubGlrZWx5IHRvIHdvcmsgaW4gb3RoZXIgQU1EIGltcGxlbWVudGF0aW9ucy5cbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIG1haW4odW5kZWYsIGRlcHMsIGNhbGxiYWNrLCByZWxOYW1lKTtcbiAgICAgICAgICAgIH0sIDQpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlcTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogSnVzdCBkcm9wcyB0aGUgY29uZmlnIG9uIHRoZSBmbG9vciwgYnV0IHJldHVybnMgcmVxIGluIGNhc2VcbiAgICAgKiB0aGUgY29uZmlnIHJldHVybiB2YWx1ZSBpcyB1c2VkLlxuICAgICAqL1xuICAgIHJlcS5jb25maWcgPSBmdW5jdGlvbiAoY2ZnKSB7XG4gICAgICAgIHJldHVybiByZXEoY2ZnKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogRXhwb3NlIG1vZHVsZSByZWdpc3RyeSBmb3IgZGVidWdnaW5nIGFuZCB0b29saW5nXG4gICAgICovXG4gICAgcmVxdWlyZWpzLl9kZWZpbmVkID0gZGVmaW5lZDtcblxuICAgIGRlZmluZSA9IGZ1bmN0aW9uIChuYW1lLCBkZXBzLCBjYWxsYmFjaykge1xuICAgICAgICBpZiAodHlwZW9mIG5hbWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1NlZSBhbG1vbmQgUkVBRE1FOiBpbmNvcnJlY3QgbW9kdWxlIGJ1aWxkLCBubyBtb2R1bGUgbmFtZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9UaGlzIG1vZHVsZSBtYXkgbm90IGhhdmUgZGVwZW5kZW5jaWVzXG4gICAgICAgIGlmICghZGVwcy5zcGxpY2UpIHtcbiAgICAgICAgICAgIC8vZGVwcyBpcyBub3QgYW4gYXJyYXksIHNvIHByb2JhYmx5IG1lYW5zXG4gICAgICAgICAgICAvL2FuIG9iamVjdCBsaXRlcmFsIG9yIGZhY3RvcnkgZnVuY3Rpb24gZm9yXG4gICAgICAgICAgICAvL3RoZSB2YWx1ZS4gQWRqdXN0IGFyZ3MuXG4gICAgICAgICAgICBjYWxsYmFjayA9IGRlcHM7XG4gICAgICAgICAgICBkZXBzID0gW107XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWhhc1Byb3AoZGVmaW5lZCwgbmFtZSkgJiYgIWhhc1Byb3Aod2FpdGluZywgbmFtZSkpIHtcbiAgICAgICAgICAgIHdhaXRpbmdbbmFtZV0gPSBbbmFtZSwgZGVwcywgY2FsbGJhY2tdO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGRlZmluZS5hbWQgPSB7XG4gICAgICAgIGpRdWVyeTogdHJ1ZVxuICAgIH07XG59KCkpO1xuXG5kZWZpbmUoXCJhbG1vbmRcIiwgZnVuY3Rpb24oKXt9KTtcblxuIiwiZnVuY3Rpb24gYnJvd3NlckRldGVjdG9yKG5hdmlnYXRvcikge1xyXG4gICAgaWYgKHR5cGVvZiBuYXZpZ2F0b3IgPT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBwcm9jZXNzID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHRocm93ICdQbGVhc2UgZ2l2ZSBuYXZpZ2F0b3IuXFxuJyArXHJcbiAgICAgICAgICAgICAgJz4gYnJvd3NlcihuYXZpZ2F0b3Igb3Igd2luZG93Lm5hdmlnYXRvciknO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgbmFtZTogJ25vZGUnLFxyXG4gICAgICAgICAgICB2ZXJzaW9uOiBwcm9jZXNzLnZlcnNpb24uc2xpY2UoMSlcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vICogUmVmZXJlbmNlZCBEYW1vbk9laGxtYW4vZGV0ZWN0LWJyb3dzZXJcclxuICAgIHZhciBicm93c2VycyA9IFtcclxuICAgICAgICBbJ2VkZ2UnLCAvRWRnZVxcLyhbMC05XFwuX10rKS9dLFxyXG4gICAgICAgIFsneWFuZGV4YnJvd3NlcicsIC9ZYUJyb3dzZXJcXC8oWzAtOVxcLl9dKykvXSxcclxuICAgICAgICBbJ2Nocm9tZScsIC8oPyFDaHJvbS4qT1BSKUNocm9tKD86ZXxpdW0pXFwvKFswLTlcXC5dKykoOj9cXHN8JCkvXSxcclxuICAgICAgICBbJ2NyaW9zJywgL0NyaU9TXFwvKFswLTlcXC5dKykoOj9cXHN8JCkvXSxcclxuICAgICAgICBbJ2ZpcmVmb3gnLCAvRmlyZWZveFxcLyhbMC05XFwuXSspKD86XFxzfCQpL10sXHJcbiAgICAgICAgWydvcGVyYScsIC9PcGVyYVxcLyhbMC05XFwuXSspKD86XFxzfCQpL10sXHJcbiAgICAgICAgWydvcGVyYScsIC9PUFJcXC8oWzAtOVxcLl0rKSg6P1xcc3wkKSQvXSxcclxuICAgICAgICBbJ2llJywgL1RyaWRlbnRcXC83XFwuMC4qcnZcXDooWzAtOVxcLl0rKVxcKS4qR2Vja28kL10sXHJcbiAgICAgICAgWydpZScsIC9NU0lFXFxzKFswLTlcXC5dKyk7LipUcmlkZW50XFwvWzQtN10uMC9dLFxyXG4gICAgICAgIFsnaWUnLCAvTVNJRVxccyg3XFwuMCkvXSxcclxuICAgICAgICBbJ2JiMTAnLCAvQkIxMDtcXHNUb3VjaC4qVmVyc2lvblxcLyhbMC05XFwuXSspL10sXHJcbiAgICAgICAgWydhbmRyb2lkJywgL0FuZHJvaWRcXHMoWzAtOVxcLl0rKS9dLFxyXG4gICAgICAgIFsnaW9zJywgL1ZlcnNpb25cXC8oWzAtOVxcLl9dKykuKk1vYmlsZS4qU2FmYXJpLiovXSxcclxuICAgICAgICBbJ3NhZmFyaScsIC9WZXJzaW9uXFwvKFswLTlcXC5fXSspLipTYWZhcmkvXVxyXG4gICAgXTtcclxuXHJcbiAgICByZXR1cm4gYnJvd3NlcnNcclxuICAgICAgICAuZmlsdGVyKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudFsxXS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLm1hcChlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgdmFyIG1hdGNoID0gZWxlbWVudFsxXS5leGVjKG5hdmlnYXRvci51c2VyQWdlbnQpO1xyXG4gICAgICAgICAgICB2YXIgdmVyc2lvbiA9IG1hdGNoICYmIG1hdGNoWzFdLnNwbGl0KC9bLl9dLykuc2xpY2UoMCwgMyk7XHJcblxyXG4gICAgICAgICAgICBpZiAodmVyc2lvbiAmJiB2ZXJzaW9uLmxlbmd0aCA8IDMpIHtcclxuICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KHZlcnNpb24sICh2ZXJzaW9uLmxlbmd0aCA9PT0gMSkgPyBbMCwgMF0gOiBbMF0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogZWxlbWVudFswXSxcclxuICAgICAgICAgICAgICAgIHZlcnNpb246IHZlcnNpb24uam9pbignLicpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSkuc2hpZnQoKTtcclxufTtcclxuXHJcbmRlZmluZSgnYnJvd3Nlci1kZXRlY3QnLFsncG9seWZpbGxzJ10sICgpID0+IHtcclxuICAgIHJldHVybiBicm93c2VyRGV0ZWN0b3I7XHJcbn0pO1xyXG5cbiIsImRlZmluZSgnbWFpbicsWydicm93c2VyLWRldGVjdCddLCAoYnJvd3NlckRldGVjdCkgPT4ge1xyXG4gICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgICB2YXIgbmF2aWdhdG9yID0gKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnPyB3aW5kb3cubmF2aWdhdG9yIDogbmF2aWdhdG9yKTtcclxuICAgICAgICByZXR1cm4gYnJvd3NlckRldGVjdChuYXZpZ2F0b3IpO1xyXG4gICAgfTtcclxufSk7XG4iLCJpZiAoQXJyYXkucHJvdG90eXBlLm1hcCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgQXJyYXkucHJvdG90eXBlLm1hcCA9IGZ1bmN0aW9uKGZuKSB7XHJcbiAgICB2YXIgcnYgPSBbXTtcclxuICAgIFxyXG4gICAgZm9yKHZhciBpPTAsIGw9dGhpcy5sZW5ndGg7IGk8bDsgaSsrKVxyXG4gICAgICBydi5wdXNoKGZuKHRoaXNbaV0pKTtcclxuXHJcbiAgICByZXR1cm4gcnY7XHJcbiAgfTtcclxufVxyXG5cclxuaWYgKEFycmF5LnByb3RvdHlwZS5maWx0ZXIgPT09IHVuZGVmaW5lZCkge1xyXG4gIEFycmF5LnByb3RvdHlwZS5maWx0ZXIgPSBmdW5jdGlvbihmbikge1xyXG4gICAgdmFyIHJ2ID0gW107XHJcbiAgICBcclxuICAgIGZvcih2YXIgaT0wLCBsPXRoaXMubGVuZ3RoOyBpPGw7IGkrKylcclxuICAgICAgaWYgKGZuKHRoaXNbaV0pKSBydi5wdXNoKHRoaXNbaV0pO1xyXG5cclxuICAgIHJldHVybiBydjtcclxuICB9O1xyXG59XHJcbjtcbmRlZmluZShcInBvbHlmaWxsc1wiLCBmdW5jdGlvbigpe30pO1xuXG4iXX0=

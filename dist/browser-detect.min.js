!function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?module.exports=n():e.browser=n()}(this,function(){"use strict";function e(e){if(void 0===e&&"undefined"==typeof process)throw"Please give navigator.\n> browser(navigator or window.navigator)";return"undefined"!=typeof process?{name:"node",version:process.version.slice(1)}:[["edge",/Edge\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)$/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+)\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/]].filter(function(n){return n[1].test(e.userAgent)}).map(function(n){var r=n[1].exec(e.userAgent),o=r&&r[1].split(/[._]/).slice(0,3),t=Array.prototype.slice.call(o,1).join("")||"0";return o&&o.length<3&&Array.prototype.push.apply(o,1===o.length?[0,0]:[0]),{name:n[0],version:o.join("."),versionNumber:parseFloat(o[0]+"."+t)}}).shift()}var n,r,o,t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return function(e){function i(e,n){return A.call(e,n)}function f(e,n){var r,o,t,i,f,u,s,c,l,p,a,d,y=n&&n.split("/"),m=w.map,h=m&&m["*"]||{};if(e){for(e=e.split("/"),f=e.length-1,w.nodeIdCompat&&j.test(e[f])&&(e[f]=e[f].replace(j,"")),"."===e[0].charAt(0)&&y&&(d=y.slice(0,y.length-1),e=d.concat(e)),l=0;l<e.length;l++)if("."===(a=e[l]))e.splice(l,1),l-=1;else if(".."===a){if(0===l||1===l&&".."===e[2]||".."===e[l-1])continue;l>0&&(e.splice(l-1,2),l-=2)}e=e.join("/")}if((y||h)&&m){for(r=e.split("/"),l=r.length;l>0;l-=1){if(o=r.slice(0,l).join("/"),y)for(p=y.length;p>0;p-=1)if((t=m[y.slice(0,p).join("/")])&&(t=t[o])){i=t,u=l;break}if(i)break;!s&&h&&h[o]&&(s=h[o],c=l)}!i&&s&&(i=s,u=c),i&&(r.splice(0,u,i),e=r.join("/"))}return e}function u(n,r){return function(){var o=S.call(arguments,0);return"string"!=typeof o[0]&&1===o.length&&o.push(null),m.apply(e,o.concat([n,r]))}}function s(e){return function(n){return f(n,e)}}function c(e){return function(n){v[e]=n}}function l(n){if(i(b,n)){var r=b[n];delete b[n],x[n]=!0,y.apply(e,r)}if(!i(v,n)&&!i(x,n))throw new Error("No "+n);return v[n]}function p(e){var n,r=e?e.indexOf("!"):-1;return r>-1&&(n=e.substring(0,r),e=e.substring(r+1,e.length)),[n,e]}function a(e){return e?p(e):[]}function d(e){return function(){return w&&w.config&&w.config[e]||{}}}var y,m,h,g,v={},b={},w={},x={},A=Object.prototype.hasOwnProperty,S=[].slice,j=/\.js$/;h=function(e,n){var r,o=p(e),t=o[0],i=n[1];return e=o[1],t&&(t=f(t,i),r=l(t)),t?e=r&&r.normalize?r.normalize(e,s(i)):f(e,i):(e=f(e,i),o=p(e),t=o[0],e=o[1],t&&(r=l(t))),{f:t?t+"!"+e:e,n:e,pr:t,p:r}},g={require:function(e){return u(e)},exports:function(e){var n=v[e];return void 0!==n?n:v[e]={}},module:function(e){return{id:e,uri:"",exports:v[e],config:d(e)}}},y=function(n,r,o,f){var s,p,d,y,m,w,A,S=[],j=void 0===o?"undefined":t(o);if(f=f||n,w=a(f),"undefined"===j||"function"===j){for(r=!r.length&&o.length?["require","exports","module"]:r,m=0;m<r.length;m+=1)if(y=h(r[m],w),"require"===(p=y.f))S[m]=g.require(n);else if("exports"===p)S[m]=g.exports(n),A=!0;else if("module"===p)s=S[m]=g.module(n);else if(i(v,p)||i(b,p)||i(x,p))S[m]=l(p);else{if(!y.p)throw new Error(n+" missing "+p);y.p.load(y.n,u(f,!0),c(p),{}),S[m]=v[p]}d=o?o.apply(v[n],S):void 0,n&&(s&&s.exports!==e&&s.exports!==v[n]?v[n]=s.exports:d===e&&A||(v[n]=d))}else n&&(v[n]=o)},n=r=m=function(n,r,o,t,i){if("string"==typeof n)return g[n]?g[n](r):l(h(n,a(r)).f);if(!n.splice){if(w=n,w.deps&&m(w.deps,w.callback),!r)return;r.splice?(n=r,r=o,o=null):n=e}return r=r||function(){},"function"==typeof o&&(o=t,t=i),t?y(e,n,r,o):setTimeout(function(){y(e,n,r,o)},4),m},m.config=function(e){return m(e)},n._defined=v,o=function(e,n,r){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");n.splice||(r=n,n=[]),i(v,e)||i(b,e)||(b[e]=[e,n,r])},o.amd={jQuery:!0}}(),o("almond",function(){}),void 0===Array.prototype.map&&(Array.prototype.map=function(e){for(var n=[],r=0,o=this.length;r<o;r++)n.push(e(this[r]));return n}),void 0===Array.prototype.filter&&(Array.prototype.filter=function(e){for(var n=[],r=0,o=this.length;r<o;r++)e(this[r])&&n.push(this[r]);return n}),o("polyfills",function(){}),o("browser-detect",["polyfills"],function(){return e}),o("main",["browser-detect"],function(e){return function(){var n="undefined"!=typeof window?window.navigator:n;return e(n)}}),window.browser=r("main")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFsbW9uZC5qcyIsImJyb3dzZXItZGV0ZWN0LmpzIiwibWFpbi5qcyIsInBvbHlmaWxscy5qcyJdLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwiZmFjdG9yeSIsInRoaXMiLCJuYXZpZ2F0b3IiLCJwcm9jZXNzIiwiYnJvd3NlcnMiLCJuYW1lIiwiZWxlbWVudCIsInZlcnNpb24iLCJzbGljZSIsImZpbHRlciIsIm1hcCIsImV4ZWMiLCJ1c2VyQWdlbnQiLCJqb2luIiwic3BsaXQiLCJ2ZXJzaW9uTnVtYmVyIiwicGFyc2VGbG9hdCIsImNhbGwiLCJ2ZXJzaW9uVGFpbHMiLCJsZW5ndGgiLCJBcnJheSIsInByb3RvdHlwZSIsInB1c2giLCJhcHBseSIsImJyb3dzZXJEZXRlY3QiLCJzaGlmdCIsInJlcXVpcmVqcyIsImRlZmluaW5nIiwiZGVmaW5lIiwiaGFzT3duIiwibm9ybWFsaXplIiwiYmFzZU5hbWUiLCJqIiwicGFydCIsIm5vcm1hbGl6ZWRCYXNlUGFydHMiLCJiYXNlUGFydHMiLCJzdGFyTWFwIiwic3RhckkiLCJsYXN0SW5kZXgiLCJjb25maWciLCJub2RlSWRDb21wYXQiLCJqc1N1ZmZpeFJlZ0V4cCIsInRlc3QiLCJyZXBsYWNlIiwiaSIsImNvbmNhdCIsInNwbGljZSIsIm1hcFZhbHVlIiwibmFtZVBhcnRzIiwibmFtZVNlZ21lbnQiLCJmb3VuZE1hcCIsImZvdW5kSSIsImZvdW5kU3Rhck1hcCIsIm1ha2VSZXF1aXJlIiwicmVsTmFtZSIsImZvcmNlU3luYyIsImFyZ3MiLCJhcHMiLCJhcmd1bWVudHMiLCJtYWtlTm9ybWFsaXplIiwibWFrZUxvYWQiLCJ3YWl0aW5nIiwidmFsdWUiLCJtYWluIiwiY2FsbERlcCIsImhhc1Byb3AiLCJkZWZpbmVkIiwidW5kZWYiLCJzcGxpdFByZWZpeCIsInByZWZpeCIsIkVycm9yIiwiaW5kZXgiLCJpbmRleE9mIiwibWFrZVJlbFBhcnRzIiwic3Vic3RyaW5nIiwibWFrZU1hcCIsInBsdWdpbiIsIm1ha2VDb25maWciLCJlIiwiaGFuZGxlcnMiLCJwYXJ0cyIsInJlbFJlc291cmNlTmFtZSIsInJlbFBhcnRzIiwiZiIsIm4iLCJwciIsInJlcXVpcmUiLCJpZCIsInVyaSIsImNqc01vZHVsZSIsImRlcE5hbWUiLCJ1c2luZ0V4cG9ydHMiLCJkZXBzIiwiY2FsbGJhY2siLCJjYWxsYmFja1R5cGUiLCJfdHlwZW9mIiwicCIsImxvYWQiLCJyZXQiLCJ1bmRlZmluZWQiLCJfcmVxdWlyZSIsInJlcSIsImFsdCIsInNldFRpbWVvdXQiLCJjZmciLCJfZGVmaW5lZCIsImFtZCIsImpRdWVyeSIsInJ2IiwiZm4iLCJsIl0sIm1hcHBpbmdzIjoiMkZBQUFBLE9BQUFDLFFBQUFDLG1CQUlBQyxLQUFBLFdBQ0EsMkJBR0EsT0FBQSxLQUFBQyxHQUFBLG1CQUFBQyxTQUNBQyxLQUFBQSxzR0N1QkFDLEtBQUFDLE9BRUFDLFFBQUFKLFFBQUFJLFFBQUFDLE1BQUEsTURGQUQsT0FBQUEsc0JBQUEsZ0JBQUEsMkJBQUEsU0FBQSxxREFBQSxRQUFBLDhCQUFBLFVBQUEsZ0NBQUEsUUFBQSw4QkFBQSxRQUFBLDZCQUFBLEtBQUEsNENBQUEsS0FBQSx3Q0FBQSxLQUFBLGlCQUFBLE9BQUEsc0NBQUEsVUFBQSx3QkFBQSxNQUFBLDJDQUFBLFNBQUEsaUNBQUFFLE9BQUEsU0FBQUgsbUNBQUFJLElBQUEsU0FBQUosR0FBQUQsR0FBQUEsR0FBQUMsRUFBQSxHQUFBSyxLQUFBVCxFQUFBVSxXQUFBTCxFQUFBQSxHQUFBTSxFQUFBLEdBQUFDLE1BQUEsUUFBQU4sTUFBQSxFQUFBLEdBQUFPLEVBQUFDLE1BQUFBLFVBQUFULE1BQUFVLEtBQUFWLEVBQUFXLEdBQUFBLEtBQUEsS0FBQSxHQUFBLE9BVEFYLElBQUFBLEVBQUFZLE9BQUEsR0FTQUMsTUFBQUMsVUFBQUMsS0FBQUMsTUFBQWhCLEVBQUEsSUFBQUEsRUFBQVksUUFBQSxFQUFBLElBQUEsS0FBQWQsS0FBQUMsRUFBQSx1QkFNQVMsY0FBQUMsV0FBQVQsRUFBQWlCLEdB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QUErQyxHQUlBQyxFQUNBeEMsRUFBQUEsRUFBQUksRUFBQXlCLEVBQUFDLHdDQVdBUSxHQVNBekUsRUFBQUEsT0FBQSxTQUFBNEUsR0FDQSxNQUFBSCxHQUFBaEcsSUFNQXFCLEVBQUErRSxTQUFBdkMsRUFFQXRDLEVBQUEsU0FBQXZCLEVBQUF1RixFQUFBQyxHQUNBQSxHQUFBLGdCQUFBQSxHQUNBRCxLQUFBQSxJQUFBdEIsT0FBQSw0REFJQVQsR0FBQUEsU0FJQTZDLEVBQUFkLEVBQ0FlLHVCQUlBOUMsRUFBQXhELElBQUFBLEVBQUF1RixFQUFBQyxLR2piQWpFLEVBQUE4RSxtQkFNQTlFLEVBUEEsU0FBQSw2Q0FVQVIsTUFBQUMsVUFBQVosSUFBQSxTQUFBMEYsVUFDQTlFLGdDQUdBdUYsRUFBQXRGLEtBQUFzQixFQUFBM0MsS0FBQTJDLElBQ0EsT0FBQWlFLFNBS0FWLEtBQUEvRSxNQUFBQyxVQUFBWixTQUNBbUIsTUFBQVAsVUFBQVosT0FBQSxTQUFBb0csR0ZyQkEsSUFBQSxTQUFBM0csRUFBQUEsRUFBQTRHLEVBQUE3RyxLQUFBa0IsT0FBQXlCLEVBQUFrRSxFQUFBbEUsSUFDQWlFLEVBQUE1RyxLQUFBMkMsS0FBQWdFLEVBQUF0RixLQUFBckIsS0FBQTJDLEdBREEsT0FJQWdFLEtBQ0FoRixFQUFBLFlBQUEsY0NEQUEsRUZpQ0Esa0JBQUEsYUFBQSIsImZpbGUiOiJicm93c2VyLWRldGVjdC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQGxpY2Vuc2UgYWxtb25kIDAuMy4zIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzLlxuICogUmVsZWFzZWQgdW5kZXIgTUlUIGxpY2Vuc2UsIGh0dHA6Ly9naXRodWIuY29tL3JlcXVpcmVqcy9hbG1vbmQvTElDRU5TRVxuICovXG4vL0dvaW5nIHNsb3BweSB0byBhdm9pZCAndXNlIHN0cmljdCcgc3RyaW5nIGNvc3QsIGJ1dCBzdHJpY3QgcHJhY3RpY2VzIHNob3VsZFxuLy9iZSBmb2xsb3dlZC5cbi8qZ2xvYmFsIHNldFRpbWVvdXQ6IGZhbHNlICovXG5cbnZhciByZXF1aXJlanMsIHJlcXVpcmUsIGRlZmluZTtcbihmdW5jdGlvbiAodW5kZWYpIHtcbiAgICB2YXIgbWFpbiwgcmVxLCBtYWtlTWFwLCBoYW5kbGVycyxcbiAgICAgICAgZGVmaW5lZCA9IHt9LFxuICAgICAgICB3YWl0aW5nID0ge30sXG4gICAgICAgIGNvbmZpZyA9IHt9LFxuICAgICAgICBkZWZpbmluZyA9IHt9LFxuICAgICAgICBoYXNPd24gPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LFxuICAgICAgICBhcHMgPSBbXS5zbGljZSxcbiAgICAgICAganNTdWZmaXhSZWdFeHAgPSAvXFwuanMkLztcblxuICAgIGZ1bmN0aW9uIGhhc1Byb3Aob2JqLCBwcm9wKSB7XG4gICAgICAgIHJldHVybiBoYXNPd24uY2FsbChvYmosIHByb3ApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdpdmVuIGEgcmVsYXRpdmUgbW9kdWxlIG5hbWUsIGxpa2UgLi9zb21ldGhpbmcsIG5vcm1hbGl6ZSBpdCB0b1xuICAgICAqIGEgcmVhbCBuYW1lIHRoYXQgY2FuIGJlIG1hcHBlZCB0byBhIHBhdGguXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgdGhlIHJlbGF0aXZlIG5hbWVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gYmFzZU5hbWUgYSByZWFsIG5hbWUgdGhhdCB0aGUgbmFtZSBhcmcgaXMgcmVsYXRpdmVcbiAgICAgKiB0by5cbiAgICAgKiBAcmV0dXJucyB7U3RyaW5nfSBub3JtYWxpemVkIG5hbWVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBub3JtYWxpemUobmFtZSwgYmFzZU5hbWUpIHtcbiAgICAgICAgdmFyIG5hbWVQYXJ0cywgbmFtZVNlZ21lbnQsIG1hcFZhbHVlLCBmb3VuZE1hcCwgbGFzdEluZGV4LFxuICAgICAgICAgICAgZm91bmRJLCBmb3VuZFN0YXJNYXAsIHN0YXJJLCBpLCBqLCBwYXJ0LCBub3JtYWxpemVkQmFzZVBhcnRzLFxuICAgICAgICAgICAgYmFzZVBhcnRzID0gYmFzZU5hbWUgJiYgYmFzZU5hbWUuc3BsaXQoXCIvXCIpLFxuICAgICAgICAgICAgbWFwID0gY29uZmlnLm1hcCxcbiAgICAgICAgICAgIHN0YXJNYXAgPSAobWFwICYmIG1hcFsnKiddKSB8fCB7fTtcblxuICAgICAgICAvL0FkanVzdCBhbnkgcmVsYXRpdmUgcGF0aHMuXG4gICAgICAgIGlmIChuYW1lKSB7XG4gICAgICAgICAgICBuYW1lID0gbmFtZS5zcGxpdCgnLycpO1xuICAgICAgICAgICAgbGFzdEluZGV4ID0gbmFtZS5sZW5ndGggLSAxO1xuXG4gICAgICAgICAgICAvLyBJZiB3YW50aW5nIG5vZGUgSUQgY29tcGF0aWJpbGl0eSwgc3RyaXAgLmpzIGZyb20gZW5kXG4gICAgICAgICAgICAvLyBvZiBJRHMuIEhhdmUgdG8gZG8gdGhpcyBoZXJlLCBhbmQgbm90IGluIG5hbWVUb1VybFxuICAgICAgICAgICAgLy8gYmVjYXVzZSBub2RlIGFsbG93cyBlaXRoZXIgLmpzIG9yIG5vbiAuanMgdG8gbWFwXG4gICAgICAgICAgICAvLyB0byBzYW1lIGZpbGUuXG4gICAgICAgICAgICBpZiAoY29uZmlnLm5vZGVJZENvbXBhdCAmJiBqc1N1ZmZpeFJlZ0V4cC50ZXN0KG5hbWVbbGFzdEluZGV4XSkpIHtcbiAgICAgICAgICAgICAgICBuYW1lW2xhc3RJbmRleF0gPSBuYW1lW2xhc3RJbmRleF0ucmVwbGFjZShqc1N1ZmZpeFJlZ0V4cCwgJycpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBTdGFydHMgd2l0aCBhICcuJyBzbyBuZWVkIHRoZSBiYXNlTmFtZVxuICAgICAgICAgICAgaWYgKG5hbWVbMF0uY2hhckF0KDApID09PSAnLicgJiYgYmFzZVBhcnRzKSB7XG4gICAgICAgICAgICAgICAgLy9Db252ZXJ0IGJhc2VOYW1lIHRvIGFycmF5LCBhbmQgbG9wIG9mZiB0aGUgbGFzdCBwYXJ0LFxuICAgICAgICAgICAgICAgIC8vc28gdGhhdCAuIG1hdGNoZXMgdGhhdCAnZGlyZWN0b3J5JyBhbmQgbm90IG5hbWUgb2YgdGhlIGJhc2VOYW1lJ3NcbiAgICAgICAgICAgICAgICAvL21vZHVsZS4gRm9yIGluc3RhbmNlLCBiYXNlTmFtZSBvZiAnb25lL3R3by90aHJlZScsIG1hcHMgdG9cbiAgICAgICAgICAgICAgICAvLydvbmUvdHdvL3RocmVlLmpzJywgYnV0IHdlIHdhbnQgdGhlIGRpcmVjdG9yeSwgJ29uZS90d28nIGZvclxuICAgICAgICAgICAgICAgIC8vdGhpcyBub3JtYWxpemF0aW9uLlxuICAgICAgICAgICAgICAgIG5vcm1hbGl6ZWRCYXNlUGFydHMgPSBiYXNlUGFydHMuc2xpY2UoMCwgYmFzZVBhcnRzLmxlbmd0aCAtIDEpO1xuICAgICAgICAgICAgICAgIG5hbWUgPSBub3JtYWxpemVkQmFzZVBhcnRzLmNvbmNhdChuYW1lKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9zdGFydCB0cmltRG90c1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IG5hbWUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBwYXJ0ID0gbmFtZVtpXTtcbiAgICAgICAgICAgICAgICBpZiAocGFydCA9PT0gJy4nKSB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWUuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgICAgICBpIC09IDE7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwYXJ0ID09PSAnLi4nKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIElmIGF0IHRoZSBzdGFydCwgb3IgcHJldmlvdXMgdmFsdWUgaXMgc3RpbGwgLi4sXG4gICAgICAgICAgICAgICAgICAgIC8vIGtlZXAgdGhlbSBzbyB0aGF0IHdoZW4gY29udmVydGVkIHRvIGEgcGF0aCBpdCBtYXlcbiAgICAgICAgICAgICAgICAgICAgLy8gc3RpbGwgd29yayB3aGVuIGNvbnZlcnRlZCB0byBhIHBhdGgsIGV2ZW4gdGhvdWdoXG4gICAgICAgICAgICAgICAgICAgIC8vIGFzIGFuIElEIGl0IGlzIGxlc3MgdGhhbiBpZGVhbC4gSW4gbGFyZ2VyIHBvaW50XG4gICAgICAgICAgICAgICAgICAgIC8vIHJlbGVhc2VzLCBtYXkgYmUgYmV0dGVyIHRvIGp1c3Qga2ljayBvdXQgYW4gZXJyb3IuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpID09PSAwIHx8IChpID09PSAxICYmIG5hbWVbMl0gPT09ICcuLicpIHx8IG5hbWVbaSAtIDFdID09PSAnLi4nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZS5zcGxpY2UoaSAtIDEsIDIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaSAtPSAyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9lbmQgdHJpbURvdHNcblxuICAgICAgICAgICAgbmFtZSA9IG5hbWUuam9pbignLycpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9BcHBseSBtYXAgY29uZmlnIGlmIGF2YWlsYWJsZS5cbiAgICAgICAgaWYgKChiYXNlUGFydHMgfHwgc3Rhck1hcCkgJiYgbWFwKSB7XG4gICAgICAgICAgICBuYW1lUGFydHMgPSBuYW1lLnNwbGl0KCcvJyk7XG5cbiAgICAgICAgICAgIGZvciAoaSA9IG5hbWVQYXJ0cy5sZW5ndGg7IGkgPiAwOyBpIC09IDEpIHtcbiAgICAgICAgICAgICAgICBuYW1lU2VnbWVudCA9IG5hbWVQYXJ0cy5zbGljZSgwLCBpKS5qb2luKFwiL1wiKTtcblxuICAgICAgICAgICAgICAgIGlmIChiYXNlUGFydHMpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9GaW5kIHRoZSBsb25nZXN0IGJhc2VOYW1lIHNlZ21lbnQgbWF0Y2ggaW4gdGhlIGNvbmZpZy5cbiAgICAgICAgICAgICAgICAgICAgLy9TbywgZG8gam9pbnMgb24gdGhlIGJpZ2dlc3QgdG8gc21hbGxlc3QgbGVuZ3RocyBvZiBiYXNlUGFydHMuXG4gICAgICAgICAgICAgICAgICAgIGZvciAoaiA9IGJhc2VQYXJ0cy5sZW5ndGg7IGogPiAwOyBqIC09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcFZhbHVlID0gbWFwW2Jhc2VQYXJ0cy5zbGljZSgwLCBqKS5qb2luKCcvJyldO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2Jhc2VOYW1lIHNlZ21lbnQgaGFzICBjb25maWcsIGZpbmQgaWYgaXQgaGFzIG9uZSBmb3JcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdGhpcyBuYW1lLlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hcFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwVmFsdWUgPSBtYXBWYWx1ZVtuYW1lU2VnbWVudF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hcFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vTWF0Y2gsIHVwZGF0ZSBuYW1lIHRvIHRoZSBuZXcgdmFsdWUuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kTWFwID0gbWFwVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kSSA9IGk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChmb3VuZE1hcCkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL0NoZWNrIGZvciBhIHN0YXIgbWFwIG1hdGNoLCBidXQganVzdCBob2xkIG9uIHRvIGl0LFxuICAgICAgICAgICAgICAgIC8vaWYgdGhlcmUgaXMgYSBzaG9ydGVyIHNlZ21lbnQgbWF0Y2ggbGF0ZXIgaW4gYSBtYXRjaGluZ1xuICAgICAgICAgICAgICAgIC8vY29uZmlnLCB0aGVuIGZhdm9yIG92ZXIgdGhpcyBzdGFyIG1hcC5cbiAgICAgICAgICAgICAgICBpZiAoIWZvdW5kU3Rhck1hcCAmJiBzdGFyTWFwICYmIHN0YXJNYXBbbmFtZVNlZ21lbnRdKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvdW5kU3Rhck1hcCA9IHN0YXJNYXBbbmFtZVNlZ21lbnRdO1xuICAgICAgICAgICAgICAgICAgICBzdGFySSA9IGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIWZvdW5kTWFwICYmIGZvdW5kU3Rhck1hcCkge1xuICAgICAgICAgICAgICAgIGZvdW5kTWFwID0gZm91bmRTdGFyTWFwO1xuICAgICAgICAgICAgICAgIGZvdW5kSSA9IHN0YXJJO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZm91bmRNYXApIHtcbiAgICAgICAgICAgICAgICBuYW1lUGFydHMuc3BsaWNlKDAsIGZvdW5kSSwgZm91bmRNYXApO1xuICAgICAgICAgICAgICAgIG5hbWUgPSBuYW1lUGFydHMuam9pbignLycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5hbWU7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbWFrZVJlcXVpcmUocmVsTmFtZSwgZm9yY2VTeW5jKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvL0EgdmVyc2lvbiBvZiBhIHJlcXVpcmUgZnVuY3Rpb24gdGhhdCBwYXNzZXMgYSBtb2R1bGVOYW1lXG4gICAgICAgICAgICAvL3ZhbHVlIGZvciBpdGVtcyB0aGF0IG1heSBuZWVkIHRvXG4gICAgICAgICAgICAvL2xvb2sgdXAgcGF0aHMgcmVsYXRpdmUgdG8gdGhlIG1vZHVsZU5hbWVcbiAgICAgICAgICAgIHZhciBhcmdzID0gYXBzLmNhbGwoYXJndW1lbnRzLCAwKTtcblxuICAgICAgICAgICAgLy9JZiBmaXJzdCBhcmcgaXMgbm90IHJlcXVpcmUoJ3N0cmluZycpLCBhbmQgdGhlcmUgaXMgb25seVxuICAgICAgICAgICAgLy9vbmUgYXJnLCBpdCBpcyB0aGUgYXJyYXkgZm9ybSB3aXRob3V0IGEgY2FsbGJhY2suIEluc2VydFxuICAgICAgICAgICAgLy9hIG51bGwgc28gdGhhdCB0aGUgZm9sbG93aW5nIGNvbmNhdCBpcyBjb3JyZWN0LlxuICAgICAgICAgICAgaWYgKHR5cGVvZiBhcmdzWzBdICE9PSAnc3RyaW5nJyAmJiBhcmdzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIGFyZ3MucHVzaChudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXEuYXBwbHkodW5kZWYsIGFyZ3MuY29uY2F0KFtyZWxOYW1lLCBmb3JjZVN5bmNdKSk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbWFrZU5vcm1hbGl6ZShyZWxOYW1lKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIG5vcm1hbGl6ZShuYW1lLCByZWxOYW1lKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBtYWtlTG9hZChkZXBOYW1lKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGRlZmluZWRbZGVwTmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjYWxsRGVwKG5hbWUpIHtcbiAgICAgICAgaWYgKGhhc1Byb3Aod2FpdGluZywgbmFtZSkpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gd2FpdGluZ1tuYW1lXTtcbiAgICAgICAgICAgIGRlbGV0ZSB3YWl0aW5nW25hbWVdO1xuICAgICAgICAgICAgZGVmaW5pbmdbbmFtZV0gPSB0cnVlO1xuICAgICAgICAgICAgbWFpbi5hcHBseSh1bmRlZiwgYXJncyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWhhc1Byb3AoZGVmaW5lZCwgbmFtZSkgJiYgIWhhc1Byb3AoZGVmaW5pbmcsIG5hbWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vICcgKyBuYW1lKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGVmaW5lZFtuYW1lXTtcbiAgICB9XG5cbiAgICAvL1R1cm5zIGEgcGx1Z2luIXJlc291cmNlIHRvIFtwbHVnaW4sIHJlc291cmNlXVxuICAgIC8vd2l0aCB0aGUgcGx1Z2luIGJlaW5nIHVuZGVmaW5lZCBpZiB0aGUgbmFtZVxuICAgIC8vZGlkIG5vdCBoYXZlIGEgcGx1Z2luIHByZWZpeC5cbiAgICBmdW5jdGlvbiBzcGxpdFByZWZpeChuYW1lKSB7XG4gICAgICAgIHZhciBwcmVmaXgsXG4gICAgICAgICAgICBpbmRleCA9IG5hbWUgPyBuYW1lLmluZGV4T2YoJyEnKSA6IC0xO1xuICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICAgICAgcHJlZml4ID0gbmFtZS5zdWJzdHJpbmcoMCwgaW5kZXgpO1xuICAgICAgICAgICAgbmFtZSA9IG5hbWUuc3Vic3RyaW5nKGluZGV4ICsgMSwgbmFtZS5sZW5ndGgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbcHJlZml4LCBuYW1lXTtcbiAgICB9XG5cbiAgICAvL0NyZWF0ZXMgYSBwYXJ0cyBhcnJheSBmb3IgYSByZWxOYW1lIHdoZXJlIGZpcnN0IHBhcnQgaXMgcGx1Z2luIElELFxuICAgIC8vc2Vjb25kIHBhcnQgaXMgcmVzb3VyY2UgSUQuIEFzc3VtZXMgcmVsTmFtZSBoYXMgYWxyZWFkeSBiZWVuIG5vcm1hbGl6ZWQuXG4gICAgZnVuY3Rpb24gbWFrZVJlbFBhcnRzKHJlbE5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHJlbE5hbWUgPyBzcGxpdFByZWZpeChyZWxOYW1lKSA6IFtdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1ha2VzIGEgbmFtZSBtYXAsIG5vcm1hbGl6aW5nIHRoZSBuYW1lLCBhbmQgdXNpbmcgYSBwbHVnaW5cbiAgICAgKiBmb3Igbm9ybWFsaXphdGlvbiBpZiBuZWNlc3NhcnkuIEdyYWJzIGEgcmVmIHRvIHBsdWdpblxuICAgICAqIHRvbywgYXMgYW4gb3B0aW1pemF0aW9uLlxuICAgICAqL1xuICAgIG1ha2VNYXAgPSBmdW5jdGlvbiAobmFtZSwgcmVsUGFydHMpIHtcbiAgICAgICAgdmFyIHBsdWdpbixcbiAgICAgICAgICAgIHBhcnRzID0gc3BsaXRQcmVmaXgobmFtZSksXG4gICAgICAgICAgICBwcmVmaXggPSBwYXJ0c1swXSxcbiAgICAgICAgICAgIHJlbFJlc291cmNlTmFtZSA9IHJlbFBhcnRzWzFdO1xuXG4gICAgICAgIG5hbWUgPSBwYXJ0c1sxXTtcblxuICAgICAgICBpZiAocHJlZml4KSB7XG4gICAgICAgICAgICBwcmVmaXggPSBub3JtYWxpemUocHJlZml4LCByZWxSZXNvdXJjZU5hbWUpO1xuICAgICAgICAgICAgcGx1Z2luID0gY2FsbERlcChwcmVmaXgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9Ob3JtYWxpemUgYWNjb3JkaW5nXG4gICAgICAgIGlmIChwcmVmaXgpIHtcbiAgICAgICAgICAgIGlmIChwbHVnaW4gJiYgcGx1Z2luLm5vcm1hbGl6ZSkge1xuICAgICAgICAgICAgICAgIG5hbWUgPSBwbHVnaW4ubm9ybWFsaXplKG5hbWUsIG1ha2VOb3JtYWxpemUocmVsUmVzb3VyY2VOYW1lKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG5hbWUgPSBub3JtYWxpemUobmFtZSwgcmVsUmVzb3VyY2VOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5hbWUgPSBub3JtYWxpemUobmFtZSwgcmVsUmVzb3VyY2VOYW1lKTtcbiAgICAgICAgICAgIHBhcnRzID0gc3BsaXRQcmVmaXgobmFtZSk7XG4gICAgICAgICAgICBwcmVmaXggPSBwYXJ0c1swXTtcbiAgICAgICAgICAgIG5hbWUgPSBwYXJ0c1sxXTtcbiAgICAgICAgICAgIGlmIChwcmVmaXgpIHtcbiAgICAgICAgICAgICAgICBwbHVnaW4gPSBjYWxsRGVwKHByZWZpeCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvL1VzaW5nIHJpZGljdWxvdXMgcHJvcGVydHkgbmFtZXMgZm9yIHNwYWNlIHJlYXNvbnNcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGY6IHByZWZpeCA/IHByZWZpeCArICchJyArIG5hbWUgOiBuYW1lLCAvL2Z1bGxOYW1lXG4gICAgICAgICAgICBuOiBuYW1lLFxuICAgICAgICAgICAgcHI6IHByZWZpeCxcbiAgICAgICAgICAgIHA6IHBsdWdpblxuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBtYWtlQ29uZmlnKG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAoY29uZmlnICYmIGNvbmZpZy5jb25maWcgJiYgY29uZmlnLmNvbmZpZ1tuYW1lXSkgfHwge307XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgaGFuZGxlcnMgPSB7XG4gICAgICAgIHJlcXVpcmU6IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gbWFrZVJlcXVpcmUobmFtZSk7XG4gICAgICAgIH0sXG4gICAgICAgIGV4cG9ydHM6IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICB2YXIgZSA9IGRlZmluZWRbbmFtZV07XG4gICAgICAgICAgICBpZiAodHlwZW9mIGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiAoZGVmaW5lZFtuYW1lXSA9IHt9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgbW9kdWxlOiBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpZDogbmFtZSxcbiAgICAgICAgICAgICAgICB1cmk6ICcnLFxuICAgICAgICAgICAgICAgIGV4cG9ydHM6IGRlZmluZWRbbmFtZV0sXG4gICAgICAgICAgICAgICAgY29uZmlnOiBtYWtlQ29uZmlnKG5hbWUpXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIG1haW4gPSBmdW5jdGlvbiAobmFtZSwgZGVwcywgY2FsbGJhY2ssIHJlbE5hbWUpIHtcbiAgICAgICAgdmFyIGNqc01vZHVsZSwgZGVwTmFtZSwgcmV0LCBtYXAsIGksIHJlbFBhcnRzLFxuICAgICAgICAgICAgYXJncyA9IFtdLFxuICAgICAgICAgICAgY2FsbGJhY2tUeXBlID0gdHlwZW9mIGNhbGxiYWNrLFxuICAgICAgICAgICAgdXNpbmdFeHBvcnRzO1xuXG4gICAgICAgIC8vVXNlIG5hbWUgaWYgbm8gcmVsTmFtZVxuICAgICAgICByZWxOYW1lID0gcmVsTmFtZSB8fCBuYW1lO1xuICAgICAgICByZWxQYXJ0cyA9IG1ha2VSZWxQYXJ0cyhyZWxOYW1lKTtcblxuICAgICAgICAvL0NhbGwgdGhlIGNhbGxiYWNrIHRvIGRlZmluZSB0aGUgbW9kdWxlLCBpZiBuZWNlc3NhcnkuXG4gICAgICAgIGlmIChjYWxsYmFja1R5cGUgPT09ICd1bmRlZmluZWQnIHx8IGNhbGxiYWNrVHlwZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgLy9QdWxsIG91dCB0aGUgZGVmaW5lZCBkZXBlbmRlbmNpZXMgYW5kIHBhc3MgdGhlIG9yZGVyZWRcbiAgICAgICAgICAgIC8vdmFsdWVzIHRvIHRoZSBjYWxsYmFjay5cbiAgICAgICAgICAgIC8vRGVmYXVsdCB0byBbcmVxdWlyZSwgZXhwb3J0cywgbW9kdWxlXSBpZiBubyBkZXBzXG4gICAgICAgICAgICBkZXBzID0gIWRlcHMubGVuZ3RoICYmIGNhbGxiYWNrLmxlbmd0aCA/IFsncmVxdWlyZScsICdleHBvcnRzJywgJ21vZHVsZSddIDogZGVwcztcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBkZXBzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICAgICAgbWFwID0gbWFrZU1hcChkZXBzW2ldLCByZWxQYXJ0cyk7XG4gICAgICAgICAgICAgICAgZGVwTmFtZSA9IG1hcC5mO1xuXG4gICAgICAgICAgICAgICAgLy9GYXN0IHBhdGggQ29tbW9uSlMgc3RhbmRhcmQgZGVwZW5kZW5jaWVzLlxuICAgICAgICAgICAgICAgIGlmIChkZXBOYW1lID09PSBcInJlcXVpcmVcIikge1xuICAgICAgICAgICAgICAgICAgICBhcmdzW2ldID0gaGFuZGxlcnMucmVxdWlyZShuYW1lKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRlcE5hbWUgPT09IFwiZXhwb3J0c1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vQ29tbW9uSlMgbW9kdWxlIHNwZWMgMS4xXG4gICAgICAgICAgICAgICAgICAgIGFyZ3NbaV0gPSBoYW5kbGVycy5leHBvcnRzKG5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB1c2luZ0V4cG9ydHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGVwTmFtZSA9PT0gXCJtb2R1bGVcIikge1xuICAgICAgICAgICAgICAgICAgICAvL0NvbW1vbkpTIG1vZHVsZSBzcGVjIDEuMVxuICAgICAgICAgICAgICAgICAgICBjanNNb2R1bGUgPSBhcmdzW2ldID0gaGFuZGxlcnMubW9kdWxlKG5hbWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaGFzUHJvcChkZWZpbmVkLCBkZXBOYW1lKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzUHJvcCh3YWl0aW5nLCBkZXBOYW1lKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzUHJvcChkZWZpbmluZywgZGVwTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJnc1tpXSA9IGNhbGxEZXAoZGVwTmFtZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtYXAucCkge1xuICAgICAgICAgICAgICAgICAgICBtYXAucC5sb2FkKG1hcC5uLCBtYWtlUmVxdWlyZShyZWxOYW1lLCB0cnVlKSwgbWFrZUxvYWQoZGVwTmFtZSksIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgYXJnc1tpXSA9IGRlZmluZWRbZGVwTmFtZV07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKG5hbWUgKyAnIG1pc3NpbmcgJyArIGRlcE5hbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0ID0gY2FsbGJhY2sgPyBjYWxsYmFjay5hcHBseShkZWZpbmVkW25hbWVdLCBhcmdzKSA6IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgaWYgKG5hbWUpIHtcbiAgICAgICAgICAgICAgICAvL0lmIHNldHRpbmcgZXhwb3J0cyB2aWEgXCJtb2R1bGVcIiBpcyBpbiBwbGF5LFxuICAgICAgICAgICAgICAgIC8vZmF2b3IgdGhhdCBvdmVyIHJldHVybiB2YWx1ZSBhbmQgZXhwb3J0cy4gQWZ0ZXIgdGhhdCxcbiAgICAgICAgICAgICAgICAvL2Zhdm9yIGEgbm9uLXVuZGVmaW5lZCByZXR1cm4gdmFsdWUgb3ZlciBleHBvcnRzIHVzZS5cbiAgICAgICAgICAgICAgICBpZiAoY2pzTW9kdWxlICYmIGNqc01vZHVsZS5leHBvcnRzICE9PSB1bmRlZiAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgY2pzTW9kdWxlLmV4cG9ydHMgIT09IGRlZmluZWRbbmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmaW5lZFtuYW1lXSA9IGNqc01vZHVsZS5leHBvcnRzO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmV0ICE9PSB1bmRlZiB8fCAhdXNpbmdFeHBvcnRzKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vVXNlIHRoZSByZXR1cm4gdmFsdWUgZnJvbSB0aGUgZnVuY3Rpb24uXG4gICAgICAgICAgICAgICAgICAgIGRlZmluZWRbbmFtZV0gPSByZXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKG5hbWUpIHtcbiAgICAgICAgICAgIC8vTWF5IGp1c3QgYmUgYW4gb2JqZWN0IGRlZmluaXRpb24gZm9yIHRoZSBtb2R1bGUuIE9ubHlcbiAgICAgICAgICAgIC8vd29ycnkgYWJvdXQgZGVmaW5pbmcgaWYgaGF2ZSBhIG1vZHVsZSBuYW1lLlxuICAgICAgICAgICAgZGVmaW5lZFtuYW1lXSA9IGNhbGxiYWNrO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHJlcXVpcmVqcyA9IHJlcXVpcmUgPSByZXEgPSBmdW5jdGlvbiAoZGVwcywgY2FsbGJhY2ssIHJlbE5hbWUsIGZvcmNlU3luYywgYWx0KSB7XG4gICAgICAgIGlmICh0eXBlb2YgZGVwcyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgaWYgKGhhbmRsZXJzW2RlcHNdKSB7XG4gICAgICAgICAgICAgICAgLy9jYWxsYmFjayBpbiB0aGlzIGNhc2UgaXMgcmVhbGx5IHJlbE5hbWVcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlcnNbZGVwc10oY2FsbGJhY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9KdXN0IHJldHVybiB0aGUgbW9kdWxlIHdhbnRlZC4gSW4gdGhpcyBzY2VuYXJpbywgdGhlXG4gICAgICAgICAgICAvL2RlcHMgYXJnIGlzIHRoZSBtb2R1bGUgbmFtZSwgYW5kIHNlY29uZCBhcmcgKGlmIHBhc3NlZClcbiAgICAgICAgICAgIC8vaXMganVzdCB0aGUgcmVsTmFtZS5cbiAgICAgICAgICAgIC8vTm9ybWFsaXplIG1vZHVsZSBuYW1lLCBpZiBpdCBjb250YWlucyAuIG9yIC4uXG4gICAgICAgICAgICByZXR1cm4gY2FsbERlcChtYWtlTWFwKGRlcHMsIG1ha2VSZWxQYXJ0cyhjYWxsYmFjaykpLmYpO1xuICAgICAgICB9IGVsc2UgaWYgKCFkZXBzLnNwbGljZSkge1xuICAgICAgICAgICAgLy9kZXBzIGlzIGEgY29uZmlnIG9iamVjdCwgbm90IGFuIGFycmF5LlxuICAgICAgICAgICAgY29uZmlnID0gZGVwcztcbiAgICAgICAgICAgIGlmIChjb25maWcuZGVwcykge1xuICAgICAgICAgICAgICAgIHJlcShjb25maWcuZGVwcywgY29uZmlnLmNhbGxiYWNrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjYWxsYmFjay5zcGxpY2UpIHtcbiAgICAgICAgICAgICAgICAvL2NhbGxiYWNrIGlzIGFuIGFycmF5LCB3aGljaCBtZWFucyBpdCBpcyBhIGRlcGVuZGVuY3kgbGlzdC5cbiAgICAgICAgICAgICAgICAvL0FkanVzdCBhcmdzIGlmIHRoZXJlIGFyZSBkZXBlbmRlbmNpZXNcbiAgICAgICAgICAgICAgICBkZXBzID0gY2FsbGJhY2s7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2sgPSByZWxOYW1lO1xuICAgICAgICAgICAgICAgIHJlbE5hbWUgPSBudWxsO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkZXBzID0gdW5kZWY7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvL1N1cHBvcnQgcmVxdWlyZShbJ2EnXSlcbiAgICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBmdW5jdGlvbiAoKSB7fTtcblxuICAgICAgICAvL0lmIHJlbE5hbWUgaXMgYSBmdW5jdGlvbiwgaXQgaXMgYW4gZXJyYmFjayBoYW5kbGVyLFxuICAgICAgICAvL3NvIHJlbW92ZSBpdC5cbiAgICAgICAgaWYgKHR5cGVvZiByZWxOYW1lID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICByZWxOYW1lID0gZm9yY2VTeW5jO1xuICAgICAgICAgICAgZm9yY2VTeW5jID0gYWx0O1xuICAgICAgICB9XG5cbiAgICAgICAgLy9TaW11bGF0ZSBhc3luYyBjYWxsYmFjaztcbiAgICAgICAgaWYgKGZvcmNlU3luYykge1xuICAgICAgICAgICAgbWFpbih1bmRlZiwgZGVwcywgY2FsbGJhY2ssIHJlbE5hbWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy9Vc2luZyBhIG5vbi16ZXJvIHZhbHVlIGJlY2F1c2Ugb2YgY29uY2VybiBmb3Igd2hhdCBvbGQgYnJvd3NlcnNcbiAgICAgICAgICAgIC8vZG8sIGFuZCBsYXRlc3QgYnJvd3NlcnMgXCJ1cGdyYWRlXCIgdG8gNCBpZiBsb3dlciB2YWx1ZSBpcyB1c2VkOlxuICAgICAgICAgICAgLy9odHRwOi8vd3d3LndoYXR3Zy5vcmcvc3BlY3Mvd2ViLWFwcHMvY3VycmVudC13b3JrL211bHRpcGFnZS90aW1lcnMuaHRtbCNkb20td2luZG93dGltZXJzLXNldHRpbWVvdXQ6XG4gICAgICAgICAgICAvL0lmIHdhbnQgYSB2YWx1ZSBpbW1lZGlhdGVseSwgdXNlIHJlcXVpcmUoJ2lkJykgaW5zdGVhZCAtLSBzb21ldGhpbmdcbiAgICAgICAgICAgIC8vdGhhdCB3b3JrcyBpbiBhbG1vbmQgb24gdGhlIGdsb2JhbCBsZXZlbCwgYnV0IG5vdCBndWFyYW50ZWVkIGFuZFxuICAgICAgICAgICAgLy91bmxpa2VseSB0byB3b3JrIGluIG90aGVyIEFNRCBpbXBsZW1lbnRhdGlvbnMuXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBtYWluKHVuZGVmLCBkZXBzLCBjYWxsYmFjaywgcmVsTmFtZSk7XG4gICAgICAgICAgICB9LCA0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXE7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEp1c3QgZHJvcHMgdGhlIGNvbmZpZyBvbiB0aGUgZmxvb3IsIGJ1dCByZXR1cm5zIHJlcSBpbiBjYXNlXG4gICAgICogdGhlIGNvbmZpZyByZXR1cm4gdmFsdWUgaXMgdXNlZC5cbiAgICAgKi9cbiAgICByZXEuY29uZmlnID0gZnVuY3Rpb24gKGNmZykge1xuICAgICAgICByZXR1cm4gcmVxKGNmZyk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEV4cG9zZSBtb2R1bGUgcmVnaXN0cnkgZm9yIGRlYnVnZ2luZyBhbmQgdG9vbGluZ1xuICAgICAqL1xuICAgIHJlcXVpcmVqcy5fZGVmaW5lZCA9IGRlZmluZWQ7XG5cbiAgICBkZWZpbmUgPSBmdW5jdGlvbiAobmFtZSwgZGVwcywgY2FsbGJhY2spIHtcbiAgICAgICAgaWYgKHR5cGVvZiBuYW1lICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdTZWUgYWxtb25kIFJFQURNRTogaW5jb3JyZWN0IG1vZHVsZSBidWlsZCwgbm8gbW9kdWxlIG5hbWUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vVGhpcyBtb2R1bGUgbWF5IG5vdCBoYXZlIGRlcGVuZGVuY2llc1xuICAgICAgICBpZiAoIWRlcHMuc3BsaWNlKSB7XG4gICAgICAgICAgICAvL2RlcHMgaXMgbm90IGFuIGFycmF5LCBzbyBwcm9iYWJseSBtZWFuc1xuICAgICAgICAgICAgLy9hbiBvYmplY3QgbGl0ZXJhbCBvciBmYWN0b3J5IGZ1bmN0aW9uIGZvclxuICAgICAgICAgICAgLy90aGUgdmFsdWUuIEFkanVzdCBhcmdzLlxuICAgICAgICAgICAgY2FsbGJhY2sgPSBkZXBzO1xuICAgICAgICAgICAgZGVwcyA9IFtdO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFoYXNQcm9wKGRlZmluZWQsIG5hbWUpICYmICFoYXNQcm9wKHdhaXRpbmcsIG5hbWUpKSB7XG4gICAgICAgICAgICB3YWl0aW5nW25hbWVdID0gW25hbWUsIGRlcHMsIGNhbGxiYWNrXTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBkZWZpbmUuYW1kID0ge1xuICAgICAgICBqUXVlcnk6IHRydWVcbiAgICB9O1xufSgpKTtcblxuZGVmaW5lKFwiYWxtb25kXCIsIGZ1bmN0aW9uKCl7fSk7XG5cbiIsImZ1bmN0aW9uIGJyb3dzZXJEZXRlY3RvcihuYXZpZ2F0b3IpIHtcclxuICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yID09PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgcHJvY2VzcyA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICB0aHJvdyAnUGxlYXNlIGdpdmUgbmF2aWdhdG9yLlxcbicgK1xyXG4gICAgICAgICAgICAgICc+IGJyb3dzZXIobmF2aWdhdG9yIG9yIHdpbmRvdy5uYXZpZ2F0b3IpJztcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG5hbWU6ICdub2RlJyxcclxuICAgICAgICAgICAgdmVyc2lvbjogcHJvY2Vzcy52ZXJzaW9uLnNsaWNlKDEpXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyAqIFJlZmVyZW5jZWQgRGFtb25PZWhsbWFuL2RldGVjdC1icm93c2VyXHJcbiAgICB2YXIgYnJvd3NlcnMgPSBbXHJcbiAgICAgICAgWydlZGdlJywgL0VkZ2VcXC8oWzAtOVxcLl9dKykvXSxcclxuICAgICAgICBbJ3lhbmRleGJyb3dzZXInLCAvWWFCcm93c2VyXFwvKFswLTlcXC5fXSspL10sXHJcbiAgICAgICAgWydjaHJvbWUnLCAvKD8hQ2hyb20uKk9QUilDaHJvbSg/OmV8aXVtKVxcLyhbMC05XFwuXSspKDo/XFxzfCQpL10sXHJcbiAgICAgICAgWydjcmlvcycsIC9DcmlPU1xcLyhbMC05XFwuXSspKDo/XFxzfCQpL10sXHJcbiAgICAgICAgWydmaXJlZm94JywgL0ZpcmVmb3hcXC8oWzAtOVxcLl0rKSg/Olxcc3wkKS9dLFxyXG4gICAgICAgIFsnb3BlcmEnLCAvT3BlcmFcXC8oWzAtOVxcLl0rKSg/Olxcc3wkKS9dLFxyXG4gICAgICAgIFsnb3BlcmEnLCAvT1BSXFwvKFswLTlcXC5dKykoOj9cXHN8JCkkL10sXHJcbiAgICAgICAgWydpZScsIC9UcmlkZW50XFwvN1xcLjAuKnJ2XFw6KFswLTlcXC5dKylcXCkuKkdlY2tvJC9dLFxyXG4gICAgICAgIFsnaWUnLCAvTVNJRVxccyhbMC05XFwuXSspOy4qVHJpZGVudFxcL1s0LTddLjAvXSxcclxuICAgICAgICBbJ2llJywgL01TSUVcXHMoN1xcLjApL10sXHJcbiAgICAgICAgWydiYjEwJywgL0JCMTA7XFxzVG91Y2guKlZlcnNpb25cXC8oWzAtOVxcLl0rKS9dLFxyXG4gICAgICAgIFsnYW5kcm9pZCcsIC9BbmRyb2lkXFxzKFswLTlcXC5dKykvXSxcclxuICAgICAgICBbJ2lvcycsIC9WZXJzaW9uXFwvKFswLTlcXC5fXSspLipNb2JpbGUuKlNhZmFyaS4qL10sXHJcbiAgICAgICAgWydzYWZhcmknLCAvVmVyc2lvblxcLyhbMC05XFwuX10rKS4qU2FmYXJpL11cclxuICAgIF07XHJcblxyXG4gICAgcmV0dXJuIGJyb3dzZXJzXHJcbiAgICAgICAgLmZpbHRlcihlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnRbMV0udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5tYXAoZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgIHZhciBtYXRjaCA9IGVsZW1lbnRbMV0uZXhlYyhuYXZpZ2F0b3IudXNlckFnZW50KTtcclxuICAgICAgICAgICAgdmFyIHZlcnNpb24gPSBtYXRjaCAmJiBtYXRjaFsxXS5zcGxpdCgvWy5fXS8pLnNsaWNlKDAsIDMpO1xyXG4gICAgICAgICAgICB2YXIgdmVyc2lvblRhaWxzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodmVyc2lvbiwgMSkuam9pbignJykgfHwgJzAnO1xyXG5cclxuICAgICAgICAgICAgaWYgKHZlcnNpb24gJiYgdmVyc2lvbi5sZW5ndGggPCAzKSB7XHJcbiAgICAgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseSh2ZXJzaW9uLCAodmVyc2lvbi5sZW5ndGggPT09IDEpID8gWzAsIDBdIDogWzBdKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IGVsZW1lbnRbMF0sXHJcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiB2ZXJzaW9uLmpvaW4oJy4nKSxcclxuICAgICAgICAgICAgICAgIHZlcnNpb25OdW1iZXI6IHBhcnNlRmxvYXQodmVyc2lvblswXSArICcuJyArIHZlcnNpb25UYWlscylcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KS5zaGlmdCgpO1xyXG59O1xyXG5cclxuZGVmaW5lKCdicm93c2VyLWRldGVjdCcsWydwb2x5ZmlsbHMnXSwgKCkgPT4ge1xyXG4gICAgcmV0dXJuIGJyb3dzZXJEZXRlY3RvcjtcclxufSk7XHJcblxuIiwiZGVmaW5lKCdtYWluJyxbJ2Jyb3dzZXItZGV0ZWN0J10sIChicm93c2VyRGV0ZWN0KSA9PiB7XHJcbiAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgIHZhciBuYXZpZ2F0b3IgPSAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCc/IHdpbmRvdy5uYXZpZ2F0b3IgOiBuYXZpZ2F0b3IpO1xyXG4gICAgICAgIHJldHVybiBicm93c2VyRGV0ZWN0KG5hdmlnYXRvcik7XHJcbiAgICB9O1xyXG59KTtcbiIsImlmIChBcnJheS5wcm90b3R5cGUubWFwID09PSB1bmRlZmluZWQpIHtcclxuICBBcnJheS5wcm90b3R5cGUubWFwID0gZnVuY3Rpb24oZm4pIHtcclxuICAgIHZhciBydiA9IFtdO1xyXG4gICAgXHJcbiAgICBmb3IodmFyIGk9MCwgbD10aGlzLmxlbmd0aDsgaTxsOyBpKyspXHJcbiAgICAgIHJ2LnB1c2goZm4odGhpc1tpXSkpO1xyXG5cclxuICAgIHJldHVybiBydjtcclxuICB9O1xyXG59XHJcblxyXG5pZiAoQXJyYXkucHJvdG90eXBlLmZpbHRlciA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgQXJyYXkucHJvdG90eXBlLmZpbHRlciA9IGZ1bmN0aW9uKGZuKSB7XHJcbiAgICB2YXIgcnYgPSBbXTtcclxuICAgIFxyXG4gICAgZm9yKHZhciBpPTAsIGw9dGhpcy5sZW5ndGg7IGk8bDsgaSsrKVxyXG4gICAgICBpZiAoZm4odGhpc1tpXSkpIHJ2LnB1c2godGhpc1tpXSk7XHJcblxyXG4gICAgcmV0dXJuIHJ2O1xyXG4gIH07XHJcbn1cclxuO1xuZGVmaW5lKFwicG9seWZpbGxzXCIsIGZ1bmN0aW9uKCl7fSk7XG5cbiJdfQ==
